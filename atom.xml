<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Actionary]]></title>
  <link href="http://blog.zhangliaoyuan.com/atom.xml" rel="self"/>
  <link href="http://blog.zhangliaoyuan.com/"/>
  <updated>2016-11-23T17:13:51+08:00</updated>
  <id>http://blog.zhangliaoyuan.com/</id>
  <author>
    <name><![CDATA[Eric Zhang]]></name>
    <email><![CDATA[zhang.lyuan@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Exploding Fake in Unit Test]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2016/10/24/exploding-fake-in-unit-test/"/>
    <updated>2016-10-24T21:22:49+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2016/10/24/exploding-fake-in-unit-test</id>
    <content type="html"><![CDATA[<h2>What&rsquo;s <strong>exploding fake</strong>?</h2>

<p>let&rsquo;s see below source code firstly.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">int</span> <span class="nf">a_stub</span><span class="p">(){</span>
</span><span class='line'>  <span class="n">fail</span><span class="p">(</span><span class="s">&quot;Boom!!! I shouldn&#39;t have been called!!!&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Even more popular:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">int</span> <span class="nf">a_stub</span><span class="p">(){</span>
</span><span class='line'>  <span class="n">fail</span><span class="p">(</span><span class="s">&quot;Hey!!! I&#39;m actually called! Now you can think about &quot;</span>\
</span><span class='line'>  <span class="s">&quot;what behaviour do you want me to have. Do you want me to &quot;</span>\
</span><span class='line'>  <span class="s">&quot;return a specific value?&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>So where this <strong>exploding fake</strong> will be used? For example, you would like to add unit test case for legacy code, in order to pass the compilation, you have to add hundreds of stubs, but you do NOT have enough time to check what&rsquo;s the stub purpose and return value, so you can make the stub be self exploding first. And then you can pass the compilation and add unit test case. Once there is stub exploding, then to check whether the stub shall be called, shall the stub have behaviour, and what&rsquo;s return value.</p>

<h2>Automatically generate exploding fake?</h2>

<p>As we know, lots of stubs are needed during unit testing for legacy code, is there any easy way to generate exploding fake automatically?</p>

<p>Because the stub is the dependency&rsquo;s function signature, actually, so, if you can get the dependancies&#8217; signature, that will be easy to generate, for example, tool <a href="https://github.com/terryyin/lizard.git" title="lizard repo">lizard</a> could read all the functions signature, it will be good way to write a script to generate <strong>exploding fake</strong>.</p>

<p>Actually, James Grenning has already implement such script for the <strong>exploding fake</strong> generation: <a href="https://github.com/jwgrenning/cpputest-starter-project/tree/master/tests/exploding-fakes" title="exploding fakes">source>></a></p>

<h2>Does make sense to making exploding fake for dynamic programming language?</h2>

<p>No, because the dynamic programming language is not complied and linked, it will be naturally failed once the dependency missing. In another words, it&rsquo;s self-exploding type, :p</p>

<p>&ndash; EOF &ndash;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[敏捷扫盲之XP(Extreme Programming)篇]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2016/03/09/know-xp/"/>
    <updated>2016-03-09T13:02:39+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2016/03/09/know-xp</id>
    <content type="html"><![CDATA[<h2>背景</h2>

<p>常常被很多朋友问到关于XP的问题，如什么是XP，什么又是工程实践，跟敏捷啥关系等等这样的问题。相信这些看似简单的问题，有很多人抱有同样的疑问。</p>

<p>本文旨在帮助工程师了解XP的知识点，更深入的话题请参考扩展阅读，对某一话题的辩论请移步至相应辩论区的文章，本文只做基本解释，不做更深入探讨。如果有陈述谬误，请在评论区注明，非常感谢。</p>

<h2>什么是XP？<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></h2>

<p>XP是Extreme Programming的缩写，中文译为极限编程，是Kent Beck<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>等人在上世级九十年代发明的一种软件工程方法。极限编程是一种强调团队工作的工作方式，它是多种敏捷方式的一种。与Scrum不同的是，Scrum是一种工作方式的框架，从组织到团队的设计，而XP关注的是具体的工程技术实践。XP旨在通过工程实践的合理搭配使用，使开发者们能够自信地响应客户需求。强调<strong>反馈环</strong>机制，客户与研发团队之间的反馈环，测试与开发的反馈环，具体代码实现跟单元测试之间的反馈环，结对之间的反馈环。极限编程认为在软件研发过程中，变化是无所不在的，人们不应回避变化，而应该适应变化，通过对反馈的检视，去适应变化。
<img src="http://blog.zhangliaoyuan.com/images/2016-03-09-know-xp/Extreme_Programming.svg.png" alt="Alt" /> <sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup></p>

<p>在XP中，常见的工程实践有：</p>

<h3>测试驱动开发 (TDD: Test-Driven Development)<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup></h3>

<p>也有人称之为单元测试先行。这是一种编程方式，在传统的瀑布软件开发中，人们习惯把单元测试当做测试的一部分，认为编程就是指产品代码的实现，只有在产品代码实现之后才能编写单元测试去验证代码的实现，在编程的过程中，人们更关注实现的部分，即所谓的<strong>HOW</strong>，单元测试是后置的。但是，在TDD中，单元测试被认为是描述单元需求（大部分是函数的需求）一种手段，测试用例成为一种自动化的单元测试代码，首先通过单元测试确定要实现什么，即所谓<strong>WAHT</strong>的部分，再实现产品代码，即<strong>HOW</strong>的部分，产品代码的编写始终以需求来驱动。</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2016-03-09-know-xp/red_green_refactor.jpg" alt="Alt" /></p>

<p>测试驱动开发的原理是：</p>

<ul>
<li>没有单元测试，不实现任何功能代码；</li>
<li>只编写仅能代表一种失败情况的测试代码；</li>
<li>只编写恰好能通过单元测试的产品代码。</li>
</ul>


<h3>验收测试驱动开发(ATDD)</h3>

<p>ATDD是Acceptance Test-Driven Development的缩写。很多的工程师把它理解为自动化测试驱动开发（Automatic Test Driven Development），因为在很多公司在强调测试的自动化，其实这两者之间并没有太大的联系。ATDD强调的也是需求的澄清，通过举例的手段对用户故事需求进行澄清，再接着让这些例子变成一个个的测试用例，在功能需求被实现后，用这些测试用例去验证功能实现是否满足需求，而这需求的澄清和测试用例的实现是前置在具体的开发实现之前的。因为是通过举例的形式来描述功能的需求说明，也称之为SbE（Specification by Example，中文译为实例化需求），其同样要求测试前置。可以比较着TDD的概念来理解，TDD是对函数级别的需求说明，再驱动实现，而ATDD是对用户故事的级别的需求说明，分析，再驱动实现，他们都要求测试前置，即关注<strong>WHAT</strong>。</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2016-03-09-know-xp/SbE.png" height="300" width="400" title="SbE" alt="Alt" /></p>

<p>而测试自动化是一种缩短反馈周期，实现回归测试（Regression Test）的手段。结合着持续集成系统，可以实现一键自动化的集成与部署。</p>

<h3>结对编程</h3>

<p>结对编程（Pair Programming），即两个人一起编写代码，共享显示器及键盘，一位同事担任的是navigator的角色，另一位是driver的角色。结对编程的前提是代码集体所有制（Collective Code Ownership），即代码为团队所共有，团队为代码的质量共同承担责任。一般人理解结对编程是两个人干一件事，是对人力资源的浪费，实则不然。因为：</p>

<ul>
<li>结对编程可以及时的完成结对代码审查，减少代码的缺陷率</li>
<li>结对编程可以帮助人员的能力提升</li>
<li>结对编程可以帮助攻关</li>
<li>结对编程可以提高编程工作的专注度</li>
</ul>


<p>想了解更多结对编程的内容，可以参考之前的文章：<a href="http://blog.zhangliaoyuan.com/blog/2014/11/11/pair-work/" title="Pair Programming">关于结对开发的那些事儿</a></p>

<h3>持续集成 (Continuous Integration)</h3>

<p>持续集成在XP的实践中占据着非常重要的位置。首先要了解什么是<strong>集成</strong>，然后再讨论<strong>持续</strong>的概念。集成无非就是收集、打包和验证的过程，这就是集成的概念。软件的代码由不同的人编写，需要将所有的代码从不同的位置收集到一处，然后进行编译，这就是一般SCM的概念（即软件配置管理），将编译出来的二进制文件部署到验证环境中，进行软件的验证，这就是一般传统理解的测试 <sup id="fnref:5"><a href="#fn:5" rel="footnote">5</a></sup>的概念。
为了让产品可以持续地交付到客户那里，从客户处获得客户的反馈，就有必要让产品可以持续地集成，加快集成的频率，缩短集成的周期，这就是持续的概念。为了让集成能够持续地运转，我们就有了持续集成系统，如Jekins帮助我们管理一个个持续集成的任务，Git或subversion做软件的配置管理，用自动化的编译工具对代码进行打包（因不同的开发语言而不同），自动化的单元测试，自动化的验收测试。提供一个清晰快速的反馈机制等等。进而可以演化为通过持续集成系统可以对整个开发工作进行可视化，精益方法运用到持续集成的工作中，指导项目的管理等等。进而延伸到持续部署、持续交付。</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2016-03-09-know-xp/CI.png" title="CI" alt="Alt" /> <sup id="fnref:6"><a href="#fn:6" rel="footnote">6</a></sup></p>

<p>如果XP的各个工程实践是珍珠的话，那么串起这些珍珠项链的绳子就是持续集成。</p>

<h2>如何学习和实践XP</h2>

<p>除了了解这些基本概念外，需要了解这些实践背后的本质：反馈环 —— 通过获得反馈，持续改进的方式来适应变化的能力。还有就是不断实践，这不像学习别的东西，听个概念就可以跟人辩驳，XP是一门实践性非常强的方法，与Scrum和Kanban有着非常大的不同，Scrum是组织框架设计，Kanban适用于团队局部优化，而XP却是实打实地技术实践。小到可以从单个工程师编写代码养成良好地单元测试的习惯，再到两个人结对开发，进行可以做团队的持续集成，大到整个产品级别或系统级别的持续集成和交付。不积跬步无以至千里；不积小流，无以成江海。</p>

<h2>结尾</h2>

<p>最后希望本文能够对需要了解XP的同学有所帮助，也希望有更多的朋友能够一道学习，我们不只是要成为了一名把活干完的工程师，而是成为一名如何把活干好的工程师，不是成为了一名只想着构造的工程师，而是在构造之前会想要构造什么的工程师，我们是要制造产品，而不是次品，我们不是码农，而是匠人。</p>

<p>&ndash; EOF &ndash;</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>更多内容可以参考<a href="http://www.extremeprogramming.org/" title="XP">Extreme Programming: A gentle introduction</a><a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>Kent Beck也是敏捷宣言的十七位发起人之一，<em>Test-Driven Development: By Example</em>的作者<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>图片来源https://en.wikipedia.org/wiki/Extreme_programming#/media/File:Extreme_Programming.svg<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
<li id="fn:4">
<p>可阅读Uncle Bob的<a href="http://blog.cleancoder.com/uncle-bob/2014/12/17/TheCyclesOfTDD.html" title="TDD cycles">The Cycles of TDD</a><a href="#fnref:4" rev="footnote">&#8617;</a></p></li>
<li id="fn:5">
<p>这里指狭义理解的测试概念，测试的概念可以往验证、探索等各个方向延伸讨论，这里不做展开。<a href="#fnref:5" rev="footnote">&#8617;</a></p></li>
<li id="fn:6">
<p>图片来自http://www.continuousautomation.com/<a href="#fnref:6" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Customize Your Terminal]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2015/12/05/customize-the-terminal/"/>
    <updated>2015-12-05T22:46:11+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2015/12/05/customize-the-terminal</id>
    <content type="html"><![CDATA[<h2>1. install <code>zsh</code>:</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># install zsh-5.0.7
</span><span class='line'># prerequisite: gcc ncurses-devel readline-devel pcre-devel zlib-devel
</span><span class='line'>curl -L http://jaist.dl.sourceforge.net/project/zsh/zsh/5.0.7/zsh-5.0.7.tar.bz2 | tar jx
</span><span class='line'>cd zsh-5.0.7/
</span><span class='line'>./configure --prefix=/usr/local/zsh/5.0.7 --enable-cap --enable-pcre --enable-multibyte --disable-gdbm
</span><span class='line'>make
</span><span class='line'>sudo make install
</span><span class='line'>sudo alternatives --install /usr/local/bin/zsh zsh /usr/local/zsh/5.0.7/bin/zsh 50000</span></code></pre></td></tr></table></div></figure>


<h2>2. set the default shell to <code>zsh</code>:</h2>

<h3>2.1 update the <code>/etc/shells</code>, append <code>zsh</code> path there.</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/bin/sh
</span><span class='line'>/bin/bash
</span><span class='line'>/sbin/nologin
</span><span class='line'>/usr/bin/sh
</span><span class='line'>/usr/bin/bash
</span><span class='line'>/usr/sbin/nologin
</span><span class='line'>/bin/tcsh
</span><span class='line'>/bin/csh
</span><span class='line'>/usr/local/bin/zsh
</span><span class='line'>/usr/local/zsh</span></code></pre></td></tr></table></div></figure>


<h3>2.2 change the default shell to <code>zsh</code></h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo chsh -s `which zsh`
</span><span class='line'>sudo shutdown -r 0</span></code></pre></td></tr></table></div></figure>


<h2>3. Install the <code>oh-my-zsh</code></h2>

<p><a href="https://github.com/robbyrussell/oh-my-zsh">https://github.com/robbyrussell/oh-my-zsh</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sh -c "$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"</span></code></pre></td></tr></table></div></figure>


<h2>4. cutomize the theme of terminal</h2>

<p><a href="http://www.if-not-true-then-false.com/2012/solarized-linux/">http://www.if-not-true-then-false.com/2012/solarized-linux/</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git clone https://github.com/sigurdga/gnome-terminal-colors-solarized.git
</span><span class='line'>gnome-terminal-colors-solarized/install.sh</span></code></pre></td></tr></table></div></figure>


<p>&ndash; EOF &ndash;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Successfully Host and Facilitate Coderetreat]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2015/11/12/how-to-successfully-host-and-facilitate-coderetreat/"/>
    <updated>2015-11-12T17:06:08+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2015/11/12/how-to-successfully-host-and-facilitate-coderetreat</id>
    <content type="html"><![CDATA[<p><img src="http://blog.zhangliaoyuan.com/images/2015-11-12-how-to-successfully-host-and-facilitate-coderetreat/pair-work.png" title="coderetreat pair work" alt="Alt text" /></p>

<h2>1. What&rsquo;s coderetreat</h2>

<p>Coderetreat is a day-long, intensive practice event, focusing on the fundamentals of software development and design. By providing developers the opportunity to take part in focused practice away from the pressures of &lsquo;getting things done&rsquo;, the coderetreat format has proven itself to be a highly effective means of skill improvement. You can visit <a href="http://www.coderetreat.org/" title="coderetreat">coderetreat.org</a> for details.</p>

<h2>2. What consists of  the coderetreat day?</h2>

<p>The day-long activity including: beginning, coding sessions and ending. Consider the time arrangement, there will be at least 5 sessions during that day. Beginning is reserved to introduce the coderetreat activity, sponsor, and the rules etc. The coding sessions are the major part of coderetreat day, the details will be described below. And ending part is used to retrospective of day-long whole coderetreat activity.</p>

<h2>3. What&rsquo;s consists of the session?</h2>

<p>In each session, there basically including below steps:</p>

<h3>Step 1. Delete the source code what is written in previous sessions</h3>

<p>I often was asked why we programmer shall delete the source code what is written in previous session by them, they treated the source code as asset, programmer always makes the increase the source code size, but has less opportunity to delete source code.  And remove the source code permanently helps programmers enter in new session with brand new status, new session with new constraint will make programmer has new idea.</p>

<h3>Step 2. Add new constraint in constraints-list</h3>

<p>The most interested part in coderetreat is coding under constraints. Image that, if your hands are tied, you will consider use other parts of your body. Before prepare coderetreat, facilitator shall prepare enough coding constraints carefully. Add one constraint in one session, current session shall be follow previous all constraints and new added in current session. For example, in the first session, the constraint is &ldquo;TDD is required&rdquo;, and in the second session, there is new constraint called &ldquo;No local/global variable used&rdquo;, it means in the second session, programmers shall follow two constraints.</p>

<p>Add constraints can help programmer programming in different solution, one constraint would help programmer to realize his/her potential well.</p>

<p>Some constraint examples:</p>

<ul>
<li><strong>TDD is required</strong></li>
<li><strong>The LoC of each function shall be less than 6</strong></li>
<li><strong>No conditional statement used</strong>, for example, &ldquo;<code>if</code>, <code>if else</code>, <code>?: etc</code>&rdquo; shall be forbidden, of cause, it does not allow use <code>for</code> or <code>while</code> loop to instead of conditional statement</li>
<li><strong>Follow &ldquo;</strong>Tell, don&rsquo;t ask&rdquo; principle**</li>
<li><strong>No loop</strong></li>
<li><strong>Keyboard only</strong>, no mouse, no touchpad</li>
<li><strong>Silent</strong>: all of the programmer shall be silent, no talking, it helps programmers use the source code and unit test case to make communication, test case and source code shall be readable</li>
</ul>


<h3>Step 3. Coding to solve the problem</h3>

<p>Actually, in coderetreat, we suggest every two programmers pair programming together, and in different sessions, the pair partner shall be rotated. Alice pair programming with Denial in session 1, but Alice shall pair programming with someone else. It helps programmers get new idea, and help them how to work with new partner. During coding, as facilitator shall walk through all of pair, to get to know what&rsquo;s the situation, is there any problem, if someone stuck there, facilitator can give a clue to help them keep going forward.</p>

<h3>Step 4. Debrief and share each other</h3>

<p>In each session, shall reserve at least 5~10 minutes to collect the feedback from participants. As facilitator, you can ask &ldquo;What&rsquo;s your feeling in this session?&rdquo;, &ldquo;Is there any problem you encounter, and how do you resolve it?&rdquo;, ask programmers write down the answers on the post-it, and paste them on the wall. and share each other. To facilitator, frequency quick feedback can help to adjust coming session&rsquo;s plan. To participants, it&rsquo;s a easy way to learn other&rsquo;s idea well.</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2015-11-12-how-to-successfully-host-and-facilitate-coderetreat/session-type.jpg" width="400" title="session sharing" alt="Alt text" />
<img src="http://blog.zhangliaoyuan.com/images/2015-11-12-how-to-successfully-host-and-facilitate-coderetreat/session-sharing.jpg" width="400" title="share the idea" alt="Alt text" /></p>

<h2>4. As a host, what&rsquo;s shall be prepared before the day?</h2>

<p>As a host, you shall provide a comfortable workplace for programmers, so some logistics including:</p>

<ul>
<li>A good place</li>
<li>Nice table and chair</li>
<li>Food, snack and drinking</li>
</ul>


<p>Since in the activity, there are a lot of sharing to make, so below shall be prepare as well:</p>

<ul>
<li>Projector</li>
<li>Whiteboard</li>
<li>White paper</li>
<li>Marker pen</li>
<li>Post-it (more color)</li>
</ul>


<p>If you consider interact with other coderetreat place:</p>

<ul>
<li>Camera for live recorder</li>
<li>Audio device for live broadcast play</li>
</ul>


<p>Enroll you coderetreat on <a href="https://www.coderetreat.org" title="coderetreat.org">coderetreat website</a> , if you&rsquo;re going to organize a GDCR (Global Day of Coderetreat), please don&rsquo;t forget register it on <a href="http://gdcr.coderetreat.org/" title="gdcr">gdcr website</a>, and create you owned registration, and publish it for participants enroll. Of cause, if you registered your activity in the gdcr website, you will get support from administrator. Post your activity on twitter with tag &ldquo;#gdcr&rdquo;, &ldquo;#gdcr15&rdquo; or &ldquo;#coderetreat&rdquo; etc. for great promotion.</p>

<h2>5. As a facilitator, what&rsquo;s shall be focused on the sessions?</h2>

<p>Remember that: YOU ARE FACILITATOR. This is important role during the activity, your passion can inspire people enjoy the activity well.</p>

<ul>
<li>First of all, you shall understand the whole process of coderetreat,</li>
<li>Then understand the constraints well, you can explain every constraint,</li>
<li>Know the problem well, and solve the problem under the constraint before the activity start.</li>
<li>Before session, you shall clear delivery the requirements to participants, and inspire people</li>
<li>In in the session, you shall walk through the pair, and getting to know the status, and facilitate the programmers in the right way</li>
<li>In the end of the session, you shall use right tools to get enough feedback, and help participants share the idea each other.</li>
<li>In the coderetreat ending part (the last activity of whole day), you shall make whole day retrospective.</li>
</ul>


<p><img src="http://blog.zhangliaoyuan.com/images/2015-11-12-how-to-successfully-host-and-facilitate-coderetreat/ending-retrospective.jpg" title="retrospective in ending" alt="Alt text" /></p>

<h3>How to make whole day retrospective?</h3>

<p> Actually, there are three questions facilitator shall ask:</p>

<ol>
<li>What&rsquo;s your feeling today?</li>
<li>What&rsquo;s you learned today?</li>
<li>What are you going to do related coderetreat?</li>
</ol>


<p>You can split the participants in different groups, each group has 10 persons, give everyone three green color post-it, and write down the first question&rsquo;s answer, write down 3 feelings, and paste them on the white paper external circle, and then give each member 30 seconds to share his/her feeling one by one in the group.</p>

<p>Then give everyone two yellow post-it, and write down the second question&rsquo;s answer, write down 3 learning, and paste them on the white paper middle circle, share his/her learning one by one in the group.</p>

<p>In the end, give each person one red post-it, and write down the third question&rsquo;s answer, write down the action plan, and paste it on the white paper inner circle, share the action plan one by one in the group.</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2015-11-12-how-to-successfully-host-and-facilitate-coderetreat/retrospective-way.jpg" title="retrospective way" alt="Alt text" /></p>

<p>-EOF-</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How Does TeXstudio Support Chinese Words Edit in LaTeX Under Mac]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2015/08/15/how-to-support-latex-chinese-editing-in-texstudio-under-mac/"/>
    <updated>2015-08-15T22:11:18+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2015/08/15/how-to-support-latex-chinese-editing-in-texstudio-under-mac</id>
    <content type="html"><![CDATA[<p>These days, I&rsquo;m trying to edit some Chinese text documents edit in LaTeX language. It&rsquo;s not a problem in Windows since Chinese font support, and Windows OS is popular used in Chinese forum. For English supporting is not a problem in LaTeX, but Chinese edit problem I encounter under Mac OS. I&rsquo;m trying to make the notes to remember the steps here in case of somebody needs it as well.</p>

<h3>Step 1.  Choose good editor and compiler package</h3>

<p>As friend recommend, I used <a href="http://www.texstudio.org" title="texstudio">TeXstudio</a> for my LaTeX document editing, this tool was quite good when I used under Windows, I suppose it will do great job under Mac OS as well. And Install the <a href="http://www.tug.org/mactex/" title="mactex">MacTeX</a> the LaTeX compiling supporting.</p>

<h3>Step 2. Change the <code>PDFLaTeX</code> command to <code>XeLaTeX</code></h3>

<p>The first problem I encounter is when I finish a sample document editing, and tried to compile it, TeXstudio will use the default command <code>PDFLaTeX</code> to compile it. It works under PC, but failed under Mac system. So the first thing you need to set the default command to <code>XeLaTeX</code>.
In TeXstudio, you can change the option via &ldquo;Preferences&rdquo; -> &ldquo;Build&rdquo; -> &ldquo;Default compiler&rdquo;, select the value as <code>XeLaTeX</code>. Now if you compile this document, it works fine:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='LaTeX'><span class='line'><span class="k">\documentclass</span><span class="nb">{</span>article<span class="nb">}</span>
</span><span class='line'><span class="k">\title</span><span class="nb">{</span>Hello World<span class="nb">}</span>
</span><span class='line'><span class="k">\author</span><span class="nb">{</span>Mac<span class="nb">}</span>
</span><span class='line'><span class="k">\date</span><span class="nb">{</span>2015, July 4<span class="nb">}</span>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>
</span><span class='line'>  <span class="k">\maketitle</span>
</span><span class='line'>  This is my first sound.
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>document<span class="nb">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and the result is like this:</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2015-08-15-how-to-support-latex-chinese-editing-in-texstudio-under-mac/first-result.png" title="works well" alt="Alt text" /></p>

<h3>Step 3. Support Chinese words editing</h3>

<p>But if we change the English content to Chinese, it doesn&rsquo;t work well, such like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='LaTeX'><span class='line'><span class="k">\documentclass</span><span class="nb">{</span>article<span class="nb">}</span>
</span><span class='line'><span class="k">\title</span><span class="nb">{</span>你好，世界<span class="nb">}</span>
</span><span class='line'><span class="k">\author</span><span class="nb">{</span>Mac<span class="nb">}</span>
</span><span class='line'><span class="k">\date</span><span class="nb">{</span>2015, July 4<span class="nb">}</span>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>
</span><span class='line'>  <span class="k">\maketitle</span>
</span><span class='line'>  这是我呐喊出来的第一句话。
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>document<span class="nb">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Except the English words can be displayed well, everything is mass, unreadable. So we need use <code>ctex</code> package to support it. so add the <code>\usepackage{ctex}</code> after <code>\documentclass{article}</code>, the result is still bad. So I realize the problem might be caused by the fonts supporting. And then I inserted these lines before <code>\begin{document}</code>, the document like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='LaTeX'><span class='line'><span class="k">\documentclass</span><span class="nb">{</span>article<span class="nb">}</span>
</span><span class='line'><span class="k">\usepackage</span><span class="nb">{</span>ctex<span class="nb">}</span>
</span><span class='line'><span class="k">\title</span><span class="nb">{</span>你好，世界<span class="nb">}</span>
</span><span class='line'><span class="k">\author</span><span class="nb">{</span>Mac<span class="nb">}</span>
</span><span class='line'><span class="k">\setCJKmainfont</span><span class="nb">{</span>Kaiti TC Regular<span class="nb">}</span>
</span><span class='line'><span class="k">\setCJKsansfont</span><span class="nb">{</span>Songti TC Regular<span class="nb">}</span>
</span><span class='line'><span class="k">\setCJKmonofont</span><span class="nb">{</span>Heiti TC Regular<span class="nb">}</span>
</span><span class='line'><span class="k">\date</span><span class="nb">{</span>2015, July 4<span class="nb">}</span>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>
</span><span class='line'>  <span class="k">\maketitle</span>
</span><span class='line'>  这是我呐喊出来的第一句话。
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>document<span class="nb">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and change the encoding to <code>UTF-8</code></p>

<p><img src="http://blog.zhangliaoyuan.com/images/2015-08-15-how-to-support-latex-chinese-editing-in-texstudio-under-mac/encoding.png" width="500" title="select encoding" alt="Alt text" /></p>

<p>then the final result likes this:</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2015-08-15-how-to-support-latex-chinese-editing-in-texstudio-under-mac/chinese-result.png" width="500" title="Chinese result" alt="Alt text" /></p>

<h3>Step 4. How do I know the font&rsquo;s name</h3>

<p>As you see, I insert these line about the font supporting, but you may ask why I know the Chinese font name. Yes, it&rsquo;s tricky, :p
Firstly, I installed Microsoft Office, and I open the Microsoft Word, you can find the font name from the font dropbox, after you selected a font, the font text box will show its name. See, that&rsquo;s why I know the font name exactly.</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2015-08-15-how-to-support-latex-chinese-editing-in-texstudio-under-mac/font-select.png" width="400" title="font select" alt="Alt text" /></p>

<h3>In the eend</h3>

<p>Here I give an example of the Chinese words editing, hope it&rsquo;s useful for your reference.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='LaTeX'><span class='line'><span class="k">\documentclass</span><span class="nb">{</span>ctexart<span class="nb">}</span>
</span><span class='line'><span class="c">%\usepackage{ctex}</span>
</span><span class='line'><span class="k">\usepackage</span><span class="nb">{</span>xeCJK<span class="nb">}</span>
</span><span class='line'><span class="k">\setCJKmainfont</span><span class="nb">{</span>Kaiti TC Regular<span class="nb">}</span>
</span><span class='line'><span class="k">\setCJKsansfont</span><span class="nb">{</span>Songti TC Regular<span class="nb">}</span>
</span><span class='line'><span class="k">\setCJKmonofont</span><span class="nb">{</span>Heiti TC Regular<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\tableofcontents</span>
</span><span class='line'>
</span><span class='line'><span class="k">\begin</span><span class="nb">{</span>abstract<span class="nb">}</span>
</span><span class='line'>这是在文件的开头的介绍文字.本文的主要话题的简短说明.
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>abstract<span class="nb">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">\section</span><span class="nb">{</span> 前言 <span class="nb">}</span>
</span><span class='line'>在该第一部分中的一些额外的元素可以被添加。巴贝尔包将采取的翻译服务.
</span><span class='line'>
</span><span class='line'><span class="k">\section</span><span class="nb">{</span>关于数学部分<span class="nb">}</span>
</span><span class='line'>在本节中的一些数学会使用数学模型含中文字符显示。
</span><span class='line'>
</span><span class='line'>這是一個傳統的中國文字
</span><span class='line'>
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>document<span class="nb">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>-EOF-</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The Ways to Break the Dependency During Unit Testing in C/C++ Programming]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2015/05/15/thy-ways-to-break-the-dependency-during-unit-testing-in-c_c++-programming/"/>
    <updated>2015-05-15T23:01:06+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2015/05/15/thy-ways-to-break-the-dependency-during-unit-testing-in-c_c++-programming</id>
    <content type="html"><![CDATA[<p>We encourage people writes unit testing shall follow <a href="http://agileinaflash.blogspot.de/2009/02/first.html" title="Fast, Isolated, Repeatable, Self-Validating and Timely">F.I.R.S.T principle</a>, but dependency gets in the way. Especially you make unit testing under legacy code, that&rsquo;s mess. That&rsquo;s the excuse we plan to ignore unit testing during coding.</p>

<p>For example, there is SUT code is <code>game.c</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="kt">bool</span> <span class="nf">is_win</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;is_win is invoked!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">dice_points</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>function <code>is_win()</code> relies on the return value of function <code>dice_points()</code> which is defined in another file called <code>dice.c</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="kt">int</span> <span class="nf">dice_points</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;dice_points is invoked!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we would like to test <code>is_win()</code>, see the test case like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="n">TEST</span><span class="p">(</span><span class="n">VerifyGame</span><span class="p">,</span> <span class="n">test_the_game_is_win</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">CHECK</span><span class="p">(</span><span class="n">is_win</span><span class="p">());</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The problem is you don&rsquo;t know the case will be pass or not, since the dependent function <code>dice_points()</code> return value is volatile, this test case is unrepeatable. So we need define a test double called <code>stub_dice_points()</code> to replace real implementation of <code>dice_points()</code>, and return a value which is configurable, like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="k">static</span> <span class="kt">int</span> <span class="n">m_points</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">set_stub_dice_points</span><span class="p">(</span><span class="kt">int</span> <span class="n">point</span><span class="p">){</span>
</span><span class='line'>  <span class="n">m_points</span> <span class="o">=</span> <span class="n">point</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">stub_dice_points</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">m_points</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p> And during you execute <code>is_win()</code> function, use <code>stub_dice_points()</code> instead of <code>dice_points()</code>, when you implement the unit testing like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'> <span class="n">TEST</span> <span class="p">(</span><span class="n">VerifyGame</span><span class="p">,</span> <span class="n">test_bigger_than_three_points_shall_be_win</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>   <span class="n">set_stub_dice_points</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>   <span class="n">CHECK</span><span class="p">(</span><span class="n">is_win</span><span class="p">());</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>But problem is how to replace the <code>dice_points()</code> with <code>stub_dice_points()</code>? There are some ways here:</p>

<h2>1. Pre-compile macro</h2>

<p>Macro <code>#ifdef</code>,  <code>#else</code> and <code>#endif</code> can be used during pre-compile phase, to select which source code statement can be compiled. So the SUT source code <code>game.c</code> can be modified like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="kt">bool</span> <span class="nf">is_win</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;is_win is invoked!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'><span class="cp">#ifndef UNIT_TEST</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">dice_points</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'><span class="cp">#else</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">stub_dice_points</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>      <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And during compile the source code for unit testing purpose, give the <code>-DUNIT_TEST</code> compilation option, to enable the replacement. But this way requires you modify productive source code, and there will be a lot of macro like this, too ugly, and the source code readability will be getting worse.</p>

<h2>2. Function pointer replacement</h2>

<p>Another way is define a function pointer, in production code, the pointer is points a real depended function, and during unit testing, the function pointer will point the stub function, but it requires programmer change the production code like this， for example, the <code>dice.h</code> change like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="n">external</span> <span class="nf">int</span> <span class="p">(</span><span class="o">*</span><span class="n">dice_pionts</span><span class="p">)();</span>
</span></code></pre></td></tr></table></div></figure>


<p>and the <code>dice.c</code> change to this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="kt">int</span> <span class="nf">dice_points_imp</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;dice_points is invoked!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">dice_pionts</span><span class="p">)()</span> <span class="o">=</span> <span class="n">dice_points_imp</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>After that, in the test case, you can use the function pointer re-assignment like below (in cpputest framework):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="n">TEST</span><span class="p">(</span><span class="n">VerifyGame</span><span class="p">,</span> <span class="n">test_the_dice_points_is_bigger_than_3_points_shall_be_win</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">UT_PTR_SET</span><span class="p">(</span><span class="n">dice_points</span><span class="p">,</span> <span class="n">stub_dice_points</span><span class="p">);</span>
</span><span class='line'>  <span class="n">set_stub_dice_points</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
</span><span class='line'>    <span class="n">CHECK</span><span class="p">(</span><span class="n">is_win</span><span class="p">());</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The obvious disadvantage is production code changing is needed. You can image that, every function dependency shall be replaced by function pointer way, too ugly.</p>

<h2>3. Linker links replaced object</h2>

<p>Above two ways require to change the production code, is there any can avoid the production code change to complete the function replacement.
We assume the <code>game.c</code> includes <code>dice.h</code>, and <code>dice.c</code> is to implement the function <code>dice_ponits()</code> implementation. If we define another <code>stub.c</code> to implement the function <code>dice_points()</code> implementation in stub way. During compile the unit testing binary, don&rsquo;t compile the <code>dice.c</code>, just compile <code>game.c</code> and <code>stub.c</code>, and link them together to build a executable binary file.</p>

<p>But there will be another problem occurs: How many <code>*.c</code> files under testing, there will be how many unit testing executable binary files. But, if the function <code>is_win()</code> and <code>dice_points()</code> in the same file, how to replace it? It will be difficult.</p>

<h2>4. Dynamically replace</h2>

<p>Is there any way to replace the dependency without do any production code change? The answer is yes, here we would like to introduce a tricky way to replace the dependency: During the function invoking, we let the invoking jump to our defined stub function.
For example, during <code>isWin()</code> invoke <code>dice_points()</code>, we change the memory stack information, leads the invoking to jump to <code>stub_dice_points()</code>. The principle is first make the code page where <code>dice_points()</code> located writable using <code>mprotect()</code> in Linux or <code>VirtualProect()</code> in Win32. Then overwrite a <code>JMP</code> instructor which jump to <code>stub_dice_poinots()</code> at the begin of <code>dice_points()</code> binary code.</p>

<p>For example, there is a assistant source code <code>assistant.c</code> which includes <code>set_stup()</code> and <code>reset_stub()</code> implementation. The two are used to the dependency replacement:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="c1">//assistant.h</span>
</span><span class='line'><span class="cp">#ifndef __ASSISTANT_H__</span>
</span><span class='line'><span class="cp">#define __ASSISTANT_H__</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef __cplusplus</span>
</span><span class='line'><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#define JUMP_CODE_MAX   0x05</span>
</span><span class='line'><span class="cp">#define JUMP_CODE_CMD   0xE9</span>
</span><span class='line'><span class="cp">#define JUMP_CODE_RET   0xC3</span>
</span><span class='line'>
</span><span class='line'><span class="k">typedef</span> <span class="k">struct</span> <span class="n">stubInfo</span> <span class="p">{</span>
</span><span class='line'>  <span class="kt">void</span> <span class="o">*</span><span class="n">funcAddr</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">byteCode</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span> <span class="n">stubInfo</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">extern</span> <span class="kt">void</span> <span class="nf">set_stub</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">funcAddr</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">stubAddr</span><span class="p">,</span> <span class="n">stubInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">);</span>
</span><span class='line'><span class="k">extern</span> <span class="kt">void</span> <span class="nf">reset_stub</span><span class="p">(</span><span class="n">stubInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">);</span>
</span><span class='line'><span class="cp">#ifdef __cplusplus</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'><span class="cp">#endif </span><span class="cm">/* __ASSISTANT_H__ */</span><span class="cp"></span>
</span></code></pre></td></tr></table></div></figure>


<p>And the <code>assistant.c</code> is here:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="cp">#include &lt;sys/mman.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;unistd.h&gt;</span>
</span><span class='line'><span class="cp">#include &quot;assistant.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="kt">void</span> <span class="nf">set_jump_code</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">codeAddr</span><span class="p">,</span> <span class="kt">char</span> <span class="n">jumpCode</span><span class="p">[</span><span class="n">JUMP_CODE_MAX</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">pagesize</span> <span class="o">=</span> <span class="n">sysconf</span><span class="p">(</span><span class="n">_SC_PAGE_SIZE</span><span class="p">);</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">mprotect</span><span class="p">((</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span> <span class="p">((</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="n">codeAddr</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">pagesize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))),</span> <span class="n">pagesize</span><span class="p">,</span> <span class="n">PROT_READ</span> <span class="o">|</span> <span class="n">PROT_WRITE</span> <span class="o">|</span> <span class="n">PROT_EXEC</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="n">memcpy</span><span class="p">(</span><span class="n">codeAddr</span><span class="p">,</span> <span class="n">jumpCode</span><span class="p">,</span> <span class="n">JUMP_CODE_MAX</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">set_stub</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">funcAddr</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">stubAddr</span><span class="p">,</span> <span class="n">stubInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kt">char</span> <span class="n">jumpCode</span><span class="p">[</span><span class="n">JUMP_CODE_MAX</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">JUMP_CODE_CMD</span><span class="p">};</span>
</span><span class='line'>    <span class="kt">int</span>  <span class="n">dist</span> <span class="o">=</span> <span class="n">stubAddr</span> <span class="o">-</span> <span class="n">funcAddr</span> <span class="o">-</span> <span class="mi">5</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">memcpy</span><span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">jumpCode</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">dist</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">));</span>
</span><span class='line'>    <span class="n">si</span><span class="o">-&gt;</span><span class="n">funcAddr</span> <span class="o">=</span> <span class="n">funcAddr</span><span class="p">;</span>
</span><span class='line'>    <span class="n">memcpy</span><span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">si</span><span class="o">-&gt;</span><span class="n">byteCode</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">funcAddr</span><span class="p">,</span> <span class="n">JUMP_CODE_MAX</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">set_jump_code</span><span class="p">(</span><span class="n">funcAddr</span><span class="p">,</span> <span class="n">jumpCode</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">reset_stub</span><span class="p">(</span><span class="n">stubInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="kt">char</span>   <span class="n">jumpCode</span><span class="p">[</span><span class="n">JUMP_CODE_MAX</span><span class="p">];</span>
</span><span class='line'>    <span class="n">memcpy</span><span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">jumpCode</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">si</span><span class="o">-&gt;</span><span class="n">byteCode</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">JUMP_CODE_MAX</span><span class="p">);</span>
</span><span class='line'>    <span class="n">set_jump_code</span><span class="p">(</span><span class="n">si</span><span class="o">-&gt;</span><span class="n">funcAddr</span><span class="p">,</span> <span class="n">jumpCode</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And then in the unit test file, you can use the assistant function for the dependency replacement:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="n">TEST</span><span class="p">(</span><span class="n">VerifyGame</span><span class="p">,</span> <span class="n">test_the_dice_points_is_bigger_than_3_points_shall_be_win</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">stubInfo</span> <span class="n">si</span><span class="p">;</span>
</span><span class='line'>    <span class="n">set_stup</span><span class="p">(</span><span class="n">dice_points</span><span class="p">,</span> <span class="n">stub_dice_points</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">si</span><span class="p">);</span>
</span><span class='line'>    <span class="n">set_stub_dice_points</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>    <span class="n">CHECK</span><span class="p">(</span><span class="n">is_win</span><span class="p">());</span>
</span><span class='line'>    <span class="n">reset_stub</span><span class="p">(</span><span class="o">&amp;</span><span class="n">si</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>5. Inherit from abstract class, replaced in dependency injection way</h2>

<p>As we know, in OOP, there is interface concept, in C++, there is abstract class which used for interface purpose. If above the functions are defined as class way, there will be like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="c1">//game.h</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Game</span> <span class="p">{</span>
</span><span class='line'><span class="k">public</span><span class="o">:</span>
</span><span class='line'>    <span class="kt">bool</span> <span class="n">isWin</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">Dice</span> <span class="n">dice</span><span class="p">;</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">dice</span><span class="p">.</span><span class="n">points</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>and the <code>dice</code> class is like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="k">class</span> <span class="nc">Dice</span><span class="p">{</span>
</span><span class='line'><span class="k">public</span><span class="o">:</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">points</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we would like to make the replacement, we have to define an abstract class called <code>Player</code> like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="k">class</span> <span class="nc">Player</span><span class="p">{</span>
</span><span class='line'><span class="k">public</span><span class="o">:</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">points</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>And the class <code>Dice</code> inherits from <code>Player</code> like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="k">class</span> <span class="nc">Dice</span><span class="o">:</span> <span class="k">public</span> <span class="n">Player</span> <span class="p">{</span>
</span><span class='line'><span class="k">public</span><span class="o">:</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">points</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>And the <code>Game</code> class shall make some change as well:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="k">class</span> <span class="nc">Game</span> <span class="p">{</span>
</span><span class='line'><span class="k">private</span><span class="o">:</span>
</span><span class='line'>  <span class="n">Player</span> <span class="n">m_opponent</span><span class="p">;</span>
</span><span class='line'><span class="k">public</span><span class="o">:</span>
</span><span class='line'>    <span class="n">Game</span><span class="p">(</span><span class="n">Player</span> <span class="n">player</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">m_opponent</span> <span class="o">=</span> <span class="n">player</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kt">bool</span> <span class="n">isWin</span><span class="p">(){</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">m_opponent</span><span class="p">.</span><span class="n">points</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">){</span>
</span><span class='line'>          <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>    
</span><span class='line'>      <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>The constructor function is used to <a href="http://martinfowler.com/articles/injection.html" title="Inject">dependency injection</a>. In test purpose, we will inherit a new class called <code>StubDice</code> from abstract class <code>Player</code>, and use the <code>StubDice</code> replace the real <code>Dice</code> in test case:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="c1">//stub_dice.h</span>
</span><span class='line'><span class="k">class</span> <span class="nc">StubDice</span><span class="o">:</span> <span class="k">public</span> <span class="n">Player</span> <span class="p">{</span>
</span><span class='line'><span class="k">private</span><span class="o">:</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">m_points</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="k">public</span><span class="o">:</span>
</span><span class='line'>    <span class="kt">void</span> <span class="n">set_points</span><span class="p">(</span><span class="kt">int</span> <span class="n">points</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">m_points</span> <span class="o">=</span> <span class="n">points</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">points</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">m_points</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the test case, the implementation as below:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="n">TEST</span><span class="p">(</span><span class="n">VerifyGame</span><span class="p">,</span> <span class="n">test_the_dice_points_less_3_points_shall_be_lose</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">StubDice</span> <span class="n">stub</span><span class="p">;</span>
</span><span class='line'>  <span class="n">Game</span> <span class="o">*</span><span class="n">game</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Game</span><span class="p">(</span><span class="n">stub</span><span class="p">);</span>
</span><span class='line'>  <span class="n">stub</span><span class="p">.</span><span class="n">set_points</span><span class="p">(</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>  <span class="n">CHECK</span><span class="p">(</span><span class="o">!</span><span class="n">game</span><span class="o">-&gt;</span><span class="n">isWin</span><span class="p">());</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Summary</h2>

<p>We list the 5 ways of dependency breaking, it doesn&rsquo;t mean that we suggest you use the ways in unit testing. During unit testing, if we find that it&rsquo;s hard to make unit testing, we have to look back, check why it&rsquo;s too hard to implement unit testing. Is it the design problem? Is it too many dependency, why? Is there any other way to implement same requirements? Refactor your source code often, make it better.</p>

<p>Treat the unit testing as design tool, helps you make better design; treat unit testing as safety tools, facilitates you make source code change.</p>

<p>-EOF-</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Domain Name of This Site Will Be Changed Soon]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2015/04/02/use-new-domain-name/"/>
    <updated>2015-04-02T22:01:06+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2015/04/02/use-new-domain-name</id>
    <content type="html"><![CDATA[<p>Hi, my dear friends,</p>

<p>I setup zhangliaoyuan.me for two years, now the domain name will be expired soon.
But good news is, I have got new domain name with my full name dot com, so after previous zhangliaoyuan.me domain name be expired in 2015/04/19, I&rsquo;ll use new domain name <strong><a href="http://blog.zhangliaoyuan.com" title="Eric's personal web site">blog.zhangliaoyuan.com</a></strong>, I&rsquo;m looking forward to your further supporting. A bundle of thanks for all of you, keep in touch.</p>

<p>./Eric</p>

<p>-EOF-</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Misunderstanding of Unit Testing]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2015/02/03/misunderstanding-of-unit-testing/"/>
    <updated>2015-02-03T22:01:06+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2015/02/03/misunderstanding-of-unit-testing</id>
    <content type="html"><![CDATA[<p>In software development, unit testing is used for method/function verification. Most of people agree that unit testing helps on software quality improvement, but no many people deep dive. Have you really understand the relationship between unit testing and quality?</p>

<p>Most of people knows while coding a method/function, the corresponding unit testing shall be added as well. But, why? And a lot of people has misunderstanding about unit testing, I&rsquo;d like to list some ones here.</p>

<h2>Misunderstandings</h2>

<h3>1. Ask newbie to write unit testing</h3>

<p>Who shall be the author of unit testing? definitely shall be the coder himself/herself. But the situation likes this: once you finish the function/method implementation, and use a practice called &ldquo;debug&rdquo; to verify your method/function works well, then you will think the task is done, any else (unit testing) is optional. If you are key person, another task will be assigned to you, and the unit testing always will be the low prioirty task, and finally, it&rsquo;s assigned to a newbie who has the competence to take the &ldquo;low level&rdquo; tasks.</p>

<p>But unit testing purpose is to facilitate source code change, and acts as safety during coding, in TDD pratice, unit testing is used to drive development. Do you think your coding shall be driven by a newbie, how can you trust the newbie understand the requirement clearly. If you are rock climber, do you trust a newbie install a safety tool for your climbing?</p>

<p>So, the correct pratice shall be experieced person do requirement analysis and write unit testing, let the newbie to implement the function/method, your unit testing case to verify the implementation is okay or not, you take the responsibility to facilitate the source change, you are the safety officer.</p>

<h3>2. Expect to find bug through unit testing</h3>

<p>As we know, there are two types of testing called: exploratory testing and verification testing. Unit testing is verification testing, it&rsquo;s used to verify the method/function does fulfill the requirements or not. Unit testing the executable requirement specification of the product method/function.</p>

<p>The correct pratice shall be write the executable requirement as unit testing case, and implement the product method/function untill all of related unit testing cases are passed.</p>

<p>If you would like to find more bug, please make exploratory testing manually, it requires experienced tester, and be more creative.</p>

<h3>3. Pursue high coverage rate</h3>

<p>I know, there might be a KPI in your team, the unit testing line coverage rate shall be higher 80%, function coverage rate shall be 100%, and branch coverage rate, conditional coverage rate. If you can reach 100% coverage for all of above four kinds of coverage, your manager will thumb up and say &ldquo;well done&rdquo;. We spend a lot of time to pursue high coverage rate, did you think that does it worth?</p>

<p>Let&rsquo;s look below source code</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">int</span> <span class="nf">foo</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">((</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">z</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>We use <code>assertEquals(2, foo(2, 2))</code> can touch all line of the code, it means the line coverage rate is 100%, but does it mean the source code has been approven okay, I don&rsquo;t think so.</p>

<p>Source code metrics somehow likes the weather forecast report indicates, single metric does not make sense, you have to combine all of the metrics, and give you insight. Metrics just tell you there may be something wrong, you need to spend time deep dive in the source code.</p>

<p>Some managers are used to challenge team with metrics, because they read excel daily, but never read your source code.</p>

<p>Josphal has written a blog to introduce the <a href="http://www.infoq.com/cn/articles/test-coverage-rate-role" title="test coverage rate role">test coverage rate role</a>, above example is from his blog.</p>

<h3>4. Write unit testing for legacy code</h3>

<p>I really appreciate people starts to care about the legacy code, start to make refactoring, that&rsquo;s good. But only add unit testing to legacy code without refactoring legacy code is dangerous. There is a manager required his team soruce code (including legacy code) unit testing coverage rate shall reach higher 80%, so team member spent a lot of time to write the unit testing for the legacy code, and tried their best time to cover each line of code, branch, and conditions. The unit testing totally was implemented in white-box, it means if the source code logic change, there will be unit testing case failed.</p>

<p>My question is:</p>

<ul>
<li>Is your legacy code testable?</li>
<li>Is your new added unit testing case maintainable?</li>
</ul>


<p>Your unit testing case will be technical debts as well as the legacy code, trust me. Several years ago, I read a post which is written by Steven Sanderson, called <a href="http://blog.stevensanderson.com/2009/11/04/selective-unit-testing-costs-and-benefits/" title="selective unit testing">Selective Unit Testing</a> gave a great strategy to handle legacy code unit testing according to the cost and benefit balance. The article shows the legacy code can be identfied four types according to the benefit and cost. As we know, the unit testing implementation cost depends on the source code dependancy, high code dependancy means high unit testing cost:</p>

<p><img src="http://blog.stevensanderson.com/wp-content/uploads/2009/11/image.png" title="selective unit testing" alt="Alt text" /></p>

<ul>
<li><strong>Algorithm</strong>: This kind of code has complex calculation logic, but lack dependancy, all calculation is depends on the argument input value, and then give out an output. This code is exterem important, any error will lead the program computing failed. So we called it&rsquo;s high benefit and low cost, the unit testing for this kind of code is required.</li>
<li><strong>Trivial</strong>: This kind of code has simple logic, sometimes, the method just several LoC, and there is more dependancy with other source code, we call it low benefit and low cost. So we think the unit testing for this code is optional.</li>
<li><strong>Coordinator</strong>: This code acts as coordinator role, it coordinate methods/functions work, it helps the methods integration, and used to describe a specific functional scenario, for example, the initialization, main etc. It has a lot of dependancy with other source code, because it needs to invoke other functions/methods. We call it high cost, but low benefit, because the logic is simple. A lot of dependancies means you need to stub or mock, that&rsquo;s high cost. For legacy code, we won&rsquo;t make unit testing for it. Instead, we use functional testing or module testing to cover the sceniro requirements.</li>
<li><strong>Overcomplicated</strong>: This kind of code has the characters of Algorithm and Coodinator code, complex logic, and has a lot of dependancies with other code. For this kind of code, we have to refactor it to Algorithm and Coordinator codes, and then based on above strategy to decide to make unit testing or not.</li>
</ul>


<h3>5. Treat unit testing as white-box testing</h3>

<p> As academism, the unit testing is white-box testing, but I&rsquo;m hard to agree that, I suggest people write unit testing as black-box rather than white-box.</p>

<p>If we write unit testing as black-box, in another words, the test cases describe the method/function requirement, as we know, there are kinds of implementations for same one requirement. If the implementation has been changed, the unit testing case still can be used to verify the method/function correct or not. But, if you implement the unit testing in white-box way, once the production code implementation changes (method/function signature is not changed), you have to update your test case as well. How bad.</p>

<p>Unit testing implemention shall be align the requirement, not the implementation logic.</p>

<h2>Reference:</h2>

<ul>
<li><a href="http://blog.stevensanderson.com/2009/11/04/selective-unit-testing-costs-and-benefits/" title="selective unit testing">Selective Unit Testing - Cost and Benefits</a></li>
<li><a href="http://www.infoq.com/cn/articles/test-coverage-rate-role" title="test coverage rate role">Test Coverage Rate Role</a></li>
</ul>


<p>-EOF-</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Understand the D3js Data Binding]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2015/01/20/understand-d3js-data-binding/"/>
    <updated>2015-01-20T22:14:00+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2015/01/20/understand-d3js-data-binding</id>
    <content type="html"><![CDATA[<p>To be honest, it&rsquo;s not easy to understand the data binding and related DOM element updating via d3js, acutally, it&rsquo;s a basic of d3js. Here I write down my understanding here, hope it can help some d3js newbie like me.</p>

<h2>Basic concepts</h2>

<h3>Select data/DOM element pair</h3>

<p>First of all, if we would like to create a svg picture, we have to create a <code>&lt;svg&gt;</code> DOM element first in html, use below code snippet will implemet it.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#chart&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="mi">900</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>It means select an exsited element which its id equals <code>chart</code>, and append a child element <code>&lt;svg&gt;</code> under this selected element, give the attribute width equals 900px.</p>

<p>Do you know what&rsquo;s the meaning of <code>d3.selectAll()</code> during we use d3js? It means there will be several data/element(s) pair(s) be selected. We can image that, in d3js concept, every DOM element has corresponding data, it called data/element pair, like below picture shows:</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2015-01-20-understand-d3js-data-binding/pairs.png" width="300" title="data/element pairs" alt="Alt text" /></p>

<p>Okay, let&rsquo;s see what&rsquo;s happened after below source code be executed.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;http://d3js.org/d3.v3.min.js&quot;</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h1&gt;</span>Demo<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;chart&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#chart&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="mi">900</span><span class="p">);</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;rect&quot;</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span><span class='line'>    <span class="nt">&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>After <code>d3.selectAll('rect')</code>, we can image it will return a list of pair which consists of data and elements, but now, the data area is empty. You will ask, how many pairs in the list after only <code>selectAll()</code> executed, and there is no previous <code>&lt;rect&gt;</code> existed? Actually, the number is not identified if only execute this code.</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2015-01-20-understand-d3js-data-binding/element_with_empty_data.png" width="500" title="data/element pairs without data" alt="Alt text" /></p>

<p>After exectue <code>data()</code> methoed, the data and elements have been binded together, the data area will be filled the data, and the pairs number will be identified, here, the data has 3 values, so the there are 3 pairs of data/element pairs, like below picture shows:</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2015-01-20-understand-d3js-data-binding/element_with_data.png" width="500" title="data/element pairs with data" alt="Alt text" /></p>

<p>Now, the pairs has been selected, but the html file, there is no real DOM generated, we can image that, after this code snippet execution, there is only generate pair list in memory, and next, we can finish the html DOM element generating.</p>

<h3>Combile the data with element via <code>enter().append(element)</code> method</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&#39;http://d3js.org/d3.v3.min.js&#39;</span> <span class="na">charset=</span><span class="s">&#39;utf-8&#39;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h1&gt;</span>Demo<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&#39;text/javascript&#39;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#chart&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="mi">900</span><span class="p">);</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">data</span><span class="p">).</span><span class="nx">enter</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nt">&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>enter()</code> method is invoke, we can image the new added binding pairs be selected, the method will return a list of data/unknown object, actually unknown object will be identified by next method <code>append('rect')</code>, in another words, data/htmlElement pairs will be returned by <code>append('rect')</code> method. let&rsquo;s see what&rsquo;s difference bewteen <code>enter()</code> and <code>append('rect)</code>:</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2015-01-20-understand-d3js-data-binding/enter_vs_append.png" width="500" title="Difference between enter() and append() returning" alt="Alt text" /></p>

<p>And now, we can give the <code>&lt;rect&gt;</code> attributes to draw svg, for example <code>attr('width', 10)</code>, <code>attr('x', 0)</code> and <code>attr('y', 0)</code> etc.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&#39;http://d3js.org/d3.v3.min.js&#39;</span> <span class="na">charset=</span><span class="s">&#39;utf-8&#39;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h1&gt;</span>Demo<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&#39;chart&#39;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&#39;text/javascript&#39;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;#chart&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
</span><span class='line'>              <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="mi">900</span><span class="p">);</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">)</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">)</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">10</span><span class="p">;})</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">10</span><span class="p">;})</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">100</span><span class="p">});</span>
</span><span class='line'>  <span class="nt">&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>according above code snippet, the html shall be like this.</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2015-01-20-understand-d3js-data-binding/pure_new_added_objects.png" width="500" title="Add new three rects" alt="Alt text" /></p>

<p>But, if there are 3 <code>&lt;rect&gt;</code> exist, and later we would like to add more according to the data chagne, for exampe: <code>[1,2,3]</code> to <code>[1,2,3,4,5]</code>, check below code snippet.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&#39;http://d3js.org/d3.v3.min.js&#39;</span> <span class="na">charset=</span><span class="s">&#39;utf-8&#39;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h1&gt;</span>Demo<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&#39;chart&#39;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;svg</span> <span class="na">width=</span><span class="s">&#39;900&#39;</span><span class="nt">&gt;</span>
</span><span class='line'>          <span class="nt">&lt;rect</span> <span class="na">width=</span><span class="s">&#39;10&#39;</span> <span class="na">height=</span><span class="s">&#39;10&#39;</span> <span class="na">x=</span><span class="s">&#39;100&#39;</span> <span class="na">style=</span><span class="s">&#39;fill: #008000&#39;</span><span class="nt">&gt;&lt;/rect&gt;</span>
</span><span class='line'>          <span class="nt">&lt;rect</span> <span class="na">width=</span><span class="s">&#39;20&#39;</span> <span class="na">height=</span><span class="s">&#39;20&#39;</span> <span class="na">x=</span><span class="s">&#39;200&#39;</span> <span class="na">style=</span><span class="s">&#39;fill: #008000&#39;</span><span class="nt">&gt;&lt;/rect&gt;</span>
</span><span class='line'>          <span class="nt">&lt;rect</span> <span class="na">width=</span><span class="s">&#39;30&#39;</span> <span class="na">height=</span><span class="s">&#39;30&#39;</span> <span class="na">x=</span><span class="s">&#39;300&#39;</span> <span class="na">style=</span><span class="s">&#39;fill: #008000&#39;</span><span class="nt">&gt;&lt;/rect&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/svg&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&#39;text/javascript&#39;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">];</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
</span><span class='line'>              <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="mi">900</span><span class="p">);</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">s1</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s1</span><span class="p">);</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">s2</span> <span class="o">=</span> <span class="nx">s1</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s2</span><span class="p">);</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">s3</span> <span class="o">=</span> <span class="nx">s2</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">enter</span><span class="p">();</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s3</span><span class="p">);</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">s4</span> <span class="o">=</span> <span class="nx">s3</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s4</span><span class="p">);</span>
</span><span class='line'>               <span class="nx">s4</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">10</span><span class="p">;})</span>
</span><span class='line'>                      <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">10</span><span class="p">})</span>
</span><span class='line'>                  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">100</span><span class="p">})</span>
</span><span class='line'>                  <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="nt">&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>the corresponding html like this:</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2015-01-20-understand-d3js-data-binding/append_two_objects.png" width="600" title="Append two objects" alt="Alt text" /></p>

<p>first after <code>selectAll('rect')</code>, return previous existed ones, and <code>data(data)</code> method will bind two more objects, the data mapping with the element by index. <code>enter()</code> method will still keep the length of data/element pair, but only keep the two new added one, others left empty. And next call <code>append('rect')</code>, and <code>append('rect')</code> return the new two objects, coming attribute, style setting are for the new two, that&rsquo;s why we see the previous three rects are in green color, and new two are in red color.</p>

<h3>Remove the no exist data/element pair via <code>exit().remove()</code> method</h3>

<p>If there are elements existed, and we would like to remove some ones according to the data has been changed. See below code snippet shows.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&#39;http://d3js.org/d3.v3.min.js&#39;</span> <span class="na">charset=</span><span class="s">&#39;utf-8&#39;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h1&gt;</span>Demo<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&#39;chart&#39;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;svg</span> <span class="na">width=</span><span class="s">&#39;900&#39;</span><span class="nt">&gt;</span>
</span><span class='line'>          <span class="nt">&lt;rect</span> <span class="na">width=</span><span class="s">&#39;10&#39;</span> <span class="na">height=</span><span class="s">&#39;10&#39;</span> <span class="na">x=</span><span class="s">&#39;100&#39;</span> <span class="na">style=</span><span class="s">&#39;fill: #008000&#39;</span><span class="nt">&gt;&lt;/rect&gt;</span>
</span><span class='line'>          <span class="nt">&lt;rect</span> <span class="na">width=</span><span class="s">&#39;20&#39;</span> <span class="na">height=</span><span class="s">&#39;20&#39;</span> <span class="na">x=</span><span class="s">&#39;200&#39;</span> <span class="na">style=</span><span class="s">&#39;fill: #008000&#39;</span><span class="nt">&gt;&lt;/rect&gt;</span>
</span><span class='line'>          <span class="nt">&lt;rect</span> <span class="na">width=</span><span class="s">&#39;30&#39;</span> <span class="na">height=</span><span class="s">&#39;30&#39;</span> <span class="na">x=</span><span class="s">&#39;300&#39;</span> <span class="na">style=</span><span class="s">&#39;fill: #008000&#39;</span><span class="nt">&gt;&lt;/rect&gt;</span>
</span><span class='line'>          <span class="nt">&lt;rect</span> <span class="na">width=</span><span class="s">&#39;40&#39;</span> <span class="na">height=</span><span class="s">&#39;40&#39;</span> <span class="na">x=</span><span class="s">&#39;400&#39;</span> <span class="na">style=</span><span class="s">&#39;fill: #008000&#39;</span><span class="nt">&gt;&lt;/rect&gt;</span>
</span><span class='line'>          <span class="nt">&lt;rect</span> <span class="na">width=</span><span class="s">&#39;50&#39;</span> <span class="na">height=</span><span class="s">&#39;50&#39;</span> <span class="na">x=</span><span class="s">&#39;500&#39;</span> <span class="na">style=</span><span class="s">&#39;fill: #008000&#39;</span><span class="nt">&gt;&lt;/rect&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/svg&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&#39;text/javascript&#39;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
</span><span class='line'>              <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="mi">900</span><span class="p">);</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">s1</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s1</span><span class="p">);</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">s2</span> <span class="o">=</span> <span class="nx">s1</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s2</span><span class="p">);</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">s3</span> <span class="o">=</span> <span class="nx">s2</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">exit</span><span class="p">();</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s3</span><span class="p">);</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">s4</span> <span class="o">=</span> <span class="nx">s3</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s4</span><span class="p">);</span>
</span><span class='line'>  <span class="nt">&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://blog.zhangliaoyuan.com/images/2015-01-20-understand-d3js-data-binding/remove_three_objects.png" width="350" title="Remove three objects" alt="Alt text" /></p>

<p><code>svg.selectAll('rect')</code> will return the existed DOM elements, in this case, the previous existed <code>&lt;rect&gt;</code> is 5, and the <code>data(data)</code> methed will combine the data, the data only two data values, after binding, return the objects which mapping previous exist data, here mapping key is the data index. We can make an easy calculation, <code>s1</code> has 5 objects, and <code>s2</code> has 2 objects, so the <code>s3</code> will store 3 objects which is waiting to remove. So later invoke <code>exit().remove()</code> methods will remove the DOM element from html.</p>

<h2>Update parttern</h2>

<p>According above section experiment, now let&rsquo;s implement an update implementation here, the DOM element adding and removal according to the data updating.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;http://d3js.org/d3.v3.min.js&quot;</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>    <span class="nt">&lt;h1&gt;</span>Demo<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>    Data: <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;data&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;data&quot;</span><span class="nt">&gt;&lt;br&gt;</span>
</span><span class='line'>    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">value=</span><span class="s">&quot;Submit&quot;</span> <span class="na">onclick=</span><span class="s">&quot;upate()&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;chart&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#chart&quot;</span><span class="p">)</span>
</span><span class='line'>            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;svg&quot;</span><span class="p">)</span>
</span><span class='line'>            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="mi">900</span><span class="p">)</span>
</span><span class='line'>            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
</span><span class='line'>            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
</span><span class='line'>            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;transform&quot;</span><span class="p">,</span> <span class="s2">&quot;translate(20, 20)&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="kd">function</span> <span class="nx">upate</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="kd">var</span> <span class="nx">inputValue</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
</span><span class='line'>            <span class="nx">data</span> <span class="o">=</span> <span class="nx">inputValue</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;rect&quot;</span><span class="p">)</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">data</span><span class="p">).</span><span class="nx">style</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="nx">s</span><span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;rect&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="nx">s</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
</span><span class='line'>            <span class="nx">s</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">10</span><span class="p">;})</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">10</span><span class="p">})</span>
</span><span class='line'>                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">100</span><span class="p">});</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="nt">&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We enther the data via input box, and generate the svg according the data, we can set different color to the existed and new added data, that can clear to know the attributes setting for which objects.
The pattern shall be like this:</p>

<ul>
<li>data bind</li>
<li>update the existed objects attributes and style etc.</li>
<li>enter().append()</li>
<li>setting new added objects attributes and style etc.</li>
<li>exit().remove()</li>
<li>setting all objects attributes and style</li>
</ul>


<p>Another example, please check the source code which is implemented by my colleague Simon: <a href="http://jsfiddle.net/simshi/jmvbcwru/2/">http://jsfiddle.net/simshi/jmvbcwru/2/</a></p>

<p>-EOF-</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[What I Learned in Global Day of Coderetreat]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2014/11/16/what-i-learned-in-coderetreat/"/>
    <updated>2014-11-16T21:12:00+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2014/11/16/what-i-learned-in-coderetreat</id>
    <content type="html"><![CDATA[<p>We&rsquo;re now the 3rd times hosting and facilitating the Global Day of Coderetreat in Hangzhou, China. Compared with Jim Hurne coordinating the globally events, be frankly, our work is easier. Yes, it&rsquo;s easier, but I do not think it&rsquo;s not important. It always request the host and facilitator spends much more effort to prepare and continuiously improve. Personally, beside those Global Day of Coderetreat (GDCR in short), we still spended much time hosting and facilitating such like coding dojo, coding rally etc. which help programmer to practice their software design, coding skill and agile engineering practices. Here I&rsquo;d like to share what I learned from coderetreat.</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2014-11-16-what-i-learned-in-coderetreat/coding.png" title="In Coding" alt="Alt text" /></p>

<h2>Prepare as earlier as possible</h2>

<p>Even coderetreat&rsquo;s organizing is lightweight compares what&rsquo;s conference. But prepare as earler as possible makes sense. What&rsquo;re you have to prepare:</p>

<ul>
<li><p>Keep the connection with coderetreat.org, and keep you can touch the global organizer via email, if you hosted the GDCR in last year, you mail will be record in historial host naming lsit. So that, you can received first hand news from coderetreat community, about the schedule, host and faclitate guideline, experience sharing, some issues discussion. This is great opportunity to learn from expereienced person, also it&rsquo;s great time to build your reputation.</p></li>
<li><p>Join regional GDCR community. Regional community can help you prepare your event better, most of members in regional community are expert or activator in they lived city, they are more experienced in community hosting and facilitating, they can give you suggestions, their lesson and learn is indirect knowladge to you. You can copy their way of working, even share the local sponsors.</p></li>
<li><p>Look for the sponsors. GDCR is day-long event, and programmer deserved free lunch and snack, so we need sponsor supply the money and place. As an activity organizor, you can help the sponsor&rsquo;s branding. And involve more people from their company to join the community. Another way to find the money is connecting with other communities who has activity budget. For me, that&rsquo;s always not a problem, since we can align our activity with our belonged company&rsquo;s business value, boss buying our idea, and sponsor it.</p></li>
<li><p>Prepare the topic and constraits. As we know, the problem topic is always Game of Life, I&rsquo;m not going to explain why we choose Game of Life in this post. We haven&rsquo;t changed the problem topic in our three years GDCR, personally think the problem topic is not a problem since most of participants are different in different year, instead, we have to consider the contraits more carefully, and we think that, the most excited part is the constraints adding.</p></li>
<li><p>Facility. Prepare some funny video such like &ldquo;Delete your code, Yes, You&rdquo; and the movie clip of game of life, some different color post-it for the retrospective of each session, check the network connecting works well with other cities. If there is no official video channel providing, establish some hangout will be fine.</p></li>
<li><p>Advertise the event. twitter, facebook, meetup, WeChat, Weibo, and G+ such social network will be good place to market the event to audience. eventbrite, google form can be good tool for event enroll. Don&rsquo;t forget do some pre-survey to know the participants knowladge and skill level clearly.</p></li>
</ul>


<h2>Facilitating</h2>

<p>There is a video sharing for the GDCR facilitating. And thanks for GDCR global organizors, they supply the the <a href="http://gdcr.coderetreat.org/hosts/guide.html," title="hosting guideline">guideline</a> for your hosting and facilitating. In the first year we hosted and facilitated the event, we strictly follow the guideline and rules what the session shall be in 45 minutes, and then remove all code in next session. But we found that, there might be some problems for example, since all implementation has been removed, some programmer lack the sense of achievement, and each session&rsquo;s restrospetive cost a lot of time. So in this year, in the first two sessions, we let the programmers try their best to finish the basic implementation. And from the third session, we strictly require them to remove the source code, and we give a time-box for each person to share the feeling and learn and strictly to follow the rules. We also change some constraints, to practice our engineers OO design, and also give some funny contraints making a happy event.</p>

<p>After each session, we facilitator will give brief introduction about why we add the constraints, and what&rsquo;s the essential behind the constraints, and how do we adapt good practice in daily work, such sharing will help people learn more from just experiened.</p>

<h2>Summary and retrospective</h2>

<p>After finish the sessions, we will gather all programmers, and do a quick retrospective of this event, 10 persons in a group, and select an A0 size paper, to draw 3 circle in the same center. give them each person 3 green color post-it, and answer this question: What&rsquo;s your feeling about this event, write 3? And let them write down and paste on the outside circle, and share the feeling each other in they belonged group. and then, every one has 2 yellow color post-it, and write down the answer for this question: What&rsquo;s you learned from event, write 2? and paste the answer around the middle circle, and then share each other. At last, every one has 1 red color post-it, and write down the answer for this question: What&rsquo;s you next action which is related this topic, write 1? And paste the answer around the inner side circle.</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2014-11-16-what-i-learned-in-coderetreat/group-picture.png" title="Retrospective result" alt="Alt text" /></p>

<p>As a host and facilitator, we can clearly get the feedback from their sharing, for example, if the feeling is boring, there might be some facilitating problem, LOL.</p>

<p>Have a nice summary will help us to record what we did, like now, write down a post, and create a picture album, that&rsquo;s good choice. Have a fun.</p>

<p>-EOF-</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[关于结对开发的那些事儿]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2014/11/11/pair-work/"/>
    <updated>2014-11-11T21:12:00+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2014/11/11/pair-work</id>
    <content type="html"><![CDATA[<p>今天是&#8221;双11&#8221;，据说这个词已经被注册了商标，不知道这里用会不会侵权啊。这样的日子里，连上班早高峰都不堵车了，传说都是昨晚伤得，大家起不了早。这不，我的搭档都伤得要去买膏方了。</p>

<p>在这样的成双成对的日子里，让我想到了软件开发的结对。(这个引子太牵强了，LOL)在讨论结对开发的时候，我们很容易想到XP中提到的navigator与driver的形式的结对开发。那么结对开发还有其他形式吗？答案是有的。</p>

<p>我们认为，结对开发是用于团队的ramp up的利器之一。团队建立，先分析人，结对开发是一种加强团队成员彼此了解的好机会，这是一种交换学习的形式，设想一下，团队里有7位同事，如果大家都曾彼此结对工作过，大家彼此的了解会更深入，哪些人擅长什么都很清楚。</p>

<p>以老带新的形式进行结对，或者以交换学习新知识和新技能的需要进行结对。需要注意的是，结对的时候，两个人的能力水平差距不宜过大，这样会影响结对工作的效果。多鼓励团队成员自发结对工作，当然，做为经理，可以对结对进行调整，如job rotation的形式等等，多创造一些结对工作的机会。如两个程序员一起结对，程序员和测试人员结对，tutor跟newcomer结对等等。</p>

<p>我们会问，如果大家结对，有没有什么形式来保证大家在开发过程中不会走错路？其实这个问题跟结不结对没有关系，一般来说，架构师会做一个全局的考虑来避免走错路，另外，在daily meeting上也可以通过对任务的更新来发现并避免走错路，每次会议，都问一句能力比较强的同事：有没有什么建议或不同意见？</p>

<p>采用这样的结对方式，可以有效地提高团队的能力，达到团队能力的最优，我们需要的是团队能力的最优，而不是单个个体的最优。如果我们在结对的过程中发现团队的合作或配比不是最优，我们可以打乱团队，重新洗牌。</p>

<p>能不能做到结对开发，这是文化的问题。我们可以通过对能力比较强的同事设定这样的KPI来解决，如，考核该员工结对培养了多少人，另外做360度feedback来考核员工，他所曾经结对过的同事给他反馈。所以我们建议，针对刚成立起来的团队，必须做到100%的结对工作，越是关键，越是困难时期，越是要快速的将团队整体的实力进行提升，而提升的过程必须是learning through work，而结对工作就是一个比较好的手段。我们可以给团队建立一个结对工作图，只有之间有结对工作，将两者之间用线连接起来，以此来跟踪团队结对工作情况。</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2014-11-11-pair-work/pair-work-map.png" title="Pair Work Map" alt="Alt text" /></p>

<p>是不是所有工作都应该结对？很显然，不是，结对工作的目的如果是想做团队的能力培养，那么结对的工作内容应该是那些可以让一部分能力强的员工帮助这一块比较弱的员工的工作，如对某个业务模块的编程，测试用例的编写等等，而那些适合独立思考的任务，则给员工留足独立思考的空间吧。所以，员工之间可以达成一个agreement，比如，每天下午的13:00 - 16:00之间会用于pair work，而其他的时间留给各自吧。</p>

<p>为了保证团队建设的可持续性，我们建议直线经理的关注点做如下分配，50%的时间用于团队人员相关事务，30%用于项目相关的事务，而20%的时间则用于hands on的团队工作，如跟团队成员以结对的形式进行工作。这样的直线经理，才能对团队的动态进行洞悉。</p>

<p>其实结对工作可以让参与者完全投入，并能产生积极的工作压力，从这个角度来说，是有助于工作效率的提升，谁也不知道一个看似独自努力工作的人是不是在努力工作，但是，两个在一起努力工作的人肯定是在努力工作。当然，在这样的过程中，做为直线经理，需要关注并影响团队的负面情绪。做为结对开发的推广，我们可能通过KPI考核方式的改变，如考核合作这一块，鼓励尝试使用好的方法，双向推进，真下而上去educate你的经理，自上而上的要求你的团队成员。</p>

<p>通过结对开发，我们可以有效保证产品的质量和开发效率的基础上，做好团队整体能力的提升。</p>

<p>-EOF-</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[2B青年欢乐多之敏捷扫盲]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2014/09/02/talk-about-agile/"/>
    <updated>2014-09-02T23:12:00+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2014/09/02/talk-about-agile</id>
    <content type="html"><![CDATA[<p>其实，我有自知之明，我并不是最合适回答这个问题的人，因为现在大师有很多，不管是李奎也好，李鬼也罢，反正就是很多。也因为真假莫辩的原因，搞得圈里圈外各种叽叽喳喳。这不，要想在圈里圈外出个名什么的，要么旗帜鲜时的挺个流派，或者倒个敏捷，或挺或倒，一定要言辞凿凿，越激烈，越极端，就越容易博得点击量，当然，这是有风险的，要么名声大振，要么声誉扫地。其实我是挺偑服那些人的，多有勇气啊，而我就不行，只能闷头干活，不敢过多言语，为什么？怕讲错啊，万一被哪个神经病缠上，就我这压力承受能力，还不直接被K.O了。况且，就我这水平，能让自己搞明白就已经不错了。</p>

<p>可是，可是&hellip;由于工作的原因，最近我常常遇到不明真相的群众，直呼我张老师，然后请教诸这般那般。其实叫我张老师，我应得也自然，因为曾经当过老师，也乐得学生这么叫我。就我个人而言，我更愿意广义意义上就敏捷这个基础上就事论事。</p>

<p>讨论敏捷，肯定会提到敏捷宣言等等各种资料、引用、权威著作等等。但是这里水太深，一般人一时半会儿还真理解不了。那么，我想从我个人的理解试着说说，如果读者朋友觉得我说错了，也请给个comments，提醒一下，当然以后就称我为编程教练好了，如果你赞同的话，那以后就叫我为敏捷教练好了.</p>

<p>我觉得在敏捷里一个比较重要的概念就是Inspect&amp;Adapt，检视并适应。如果理解了这个概念，顺着往下理解，就很容易了。这里举个例子，有汽车驾驶经验的人一般都知道，从一个驾驶新手到熟练驾驶这个周期不会太长，一般每天上下班开车的话，一两个月就够了。作为在全国第二拥堵城市开车的我来说，从新手，到自认为老手，也就不到两个月，为什么会这么快呢？前两个月还战战兢兢，过两个月就敢跟别人卡车位，原因出在上班路上有太多的锻炼机会，从家里到单位，红绿灯几十个，十字路口N个，加上咱们国家特有的着急文化，路上状况百出，极其复杂，这样，给了我们学习足够的<strong>频度</strong>进行锻炼。另一个原因，汽车驾驶中，从做出每一个驾驶动作，到驾驶员获得<strong>反馈时间非常短</strong>，这样一个<strong>高频度</strong>和<strong>快反馈</strong>让我们很快获得了汽车驾驶能力的提升，因为，我们在驾驶过程中不停地做<strong>Inspect</strong>和<strong>Adapt</strong>。另一个例子是驾驶海上货轮，学习成本明显比汽车要高出许多，加上海上也没见多少红绿灯啊，<strong>频率低</strong>，货轮入港时的转舵，<strong>反馈周期长</strong>，也些原因决定了学习轮船驾驶要比汽车驾驶困难许多。由于不确定性因素，根据不断变化的情况，对反馈进行检视，然后对下一步的行动做出调整，以适应后续发展，快速的反馈减少我们应对单一反馈周期里的成本。应对不断变化的不确定因素，反馈是获得改进的唯一方式，这就不难理解&#8221;别人给你feedback是对你好&#8221;这句话了。</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2014-09-02-talk-about-agile/inspect_adapt_cycle.png" title="Inspect &amp; Adapt" alt="Alt text" /></p>

<p>以此，我们对应软件开发中，软件开发常常碰到的问题是不确定因素很多，客户随时可能改变需求，这有点像开车，路况总是处在变化中，软件研发团队提交产品给客户，而客户将反馈给研发团队。如果想有效地应对来自客户的变化，那么保持一定频率的反馈及快速的反馈时间将有助于及时让团队做出调整，这样，不断的调整改善，对团队而言，就是一个持续改善的过程。我们试着问，要不断从客户那边获得反馈，前提就是要可持续地提交产品给客户，就这引入了Continuous Delivery的概念（我们不再这里深入更多细节），要做好Continuous Delivery，我们必须做好持续集成Continuous Integration，要做到持续集成，我们可以通过ATDD保证需求是可迭代的持续验证，并且同时做好测试自动化。要做好持续集成，咱们得做好持续开发编译，要做好持续开发编译，咱们都做好TDD，Pairing&hellip; 随着一步步向下挖掘，我们发现，可以将很多工程实践，放到里头，如果想保证这些事情能够顺利地做好，我们定义了不同的角色，不同的check list，backlog，这样就很容易地顺着这个思路去自圆其说了，:p。当然，这时还一个概念就是迭代周期，迭代周期就是开发团队用于Inspect &amp; Adapt的节奏。迭代周期多长合适呢？</p>

<p>从产品开发的这条线走，如上所述。那么要开发产品，团队很重要，从团队角度又可以引申到哪些概念呢？如团队建设要做到Continuous Improvement，那么我们是不是得做好Retrospective，然后是Daily Meeting， working agreement &hellip;</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2014-09-02-talk-about-agile/concepts_links.png" title="Concepts Link" alt="Alt text" /></p>

<p>把这些想通了，再去顺着想别的概念就容易多了。当然，这不是敏捷的全部，否则做个大师就太容易了。这里只是想写个引子，帮助大家站在自己的角度来思考问题，希望能对大家有所帮助。对了，写到这里，我是不是得问几个问题：</p>

<ol>
<li>敏捷的开发方式好，还是传统瀑布模型好， 为什么？</li>
<li>如何在硬件研发中使用敏捷，为什么？</li>
<li>Lean与看板是什么关系，为什么？</li>
<li>Scrum好，还是Kanban好，为什么？</li>
<li>极限编程又是什么东西，为什么？</li>
<li>自组织是敏捷的前提还是结果，为什么？</li>
</ol>


<p>是不是觉得这些问题经常遇见，那为什么呢？习惯问为什么，并顺着往下想，下一篇博客你来写。</p>

<p><strong><em>注：文中图片是用keynote画的，只是个草图，如果有兴趣，大家帮忙给规整规整</em></strong></p>

<p>祝好</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[驱魔人 ——《软件驱魔术》译者序]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2014/02/24/translating-preface-of-software-exorcism/"/>
    <updated>2014-02-24T16:31:00+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2014/02/24/translating-preface-of-software-exorcism</id>
    <content type="html"><![CDATA[<p>从《画皮》里孙俪饰演的降魔人，《倩女悠魂》里古天乐饰演的猎妖师，到《西游》里年轻的驱魔人陈玄奘（文章饰）。不知道为什么，每个故事的驱魔工作者们无一例外，都是蓬头垢面，衣衫褴褛的造型。我一直在想，是什么样的工作性质，让他们如此狼狈不堪：爬高山，钻洞穴，寂寞伴身，学会守候&hellip;&hellip;</p>

<p>我本人所在项目的代码库里，包含了从上世纪八十年代到现在，跨度将近三十年的代码，这个样本都适合做代码考古了，而公司目前有几百人正在从事这套软件的维护工作，维护工作的绝大多数时间就是在与遗留代码战斗。他们需要深入代码洞穴，攀登代码树，在错综复杂的逻辑结构中跟踪每一步可能的分支结点；除了要抓到贻害一方的缺陷，并且还必须在有限的时间里完成这一切工作，这就像美剧里演的一样，一个人拿着枪指着你的头，掐着秒表，逼着你在秒表归零之前完成复杂的网络攻击任务。作者把软件维护工程师们比做软件驱魔人，这是多么贴切的比喻。我现在才惊醒，原来我身边的人本应如孙俪一样俊俏，像古天乐一样有型，似文章一般阳光清纯，而“伟大”的降妖除魔工作，却让他们一个个如降魔人，猎妖师和陈玄奘一般狼狈不堪。</p>

<p>最近听到一个真实的故事：有位1990年出生的女同事，为了解决一个BUG，不得不修改一段1993年编写的遗留代码。加班到晚上八九点之时，这位女同事大发感慨“当我还只有三岁的时候，就有一位怪叔叔写了一段代码，等20年后我长熟了再修改。” 在笑喷的同时，我们也在沉思，还有多少遗留代码是我们孩提时就已经存在，并且需要我们去修改的呢？或者，我们给正在成长的幼儿园宝宝们，又准备了多少的“遗产”呢？前人挖坑，后人填坑，子子孙孙无穷尽也，这会成为我们这些软件从业者的常态吗？</p>

<p>作者Bill Blunden试图通过<a href="http://www.apress.com/9781590592342" title="Software Exorcism"><em>Software Exorcism: A Handbook for Debugging and Optimizing Legacy Code</em></a>，告诉程序员们如何预防掉入软件维护的泥潭，冠冕点的说法，叫做从源头抓起。如果一旦进入缺陷的修改，如何进行调试，针对软件性能的提升，又有什么比较好的方法。从整本书的组织角度来看，条理性比较强。作者不求面面俱到，但从实用性的角度，还是给出了比较多的方法介绍和建议，如防御性编程，单元测试，软件跟踪，调试，优化，甚至调试器的内部实现，都有提及。本书非常适合初入软件维护队伍的从业者，对维护行列的老手来说，则会略觉浅显，但系统性的总结也是一个不错的参考。当然，对于编写软件的从业者来说，这也是一部值得学习的图书，第一部分关于如何预防，防止再次编写难于维护的代码就是不错的建议，同时，关于调优部分也一样受用。</p>

<p>在市面上各种编程语言介绍之类的图书大行其道的当下，这样一部专门讲授如何维护遗留代码的图书就显得异外扎眼。作者并没有提及太过高深的理论或技法，让人的感觉是更多的内容都是来自作者一线维护工作中的点点滴滴的经验总结。</p>

<p>参加本书翻译的几位译者都是IT从业人员，有着近十年的一线软件研发和维护经验，书中的描写更能引起一些共鸣，这也是我们将此书介绍给国内读者的初衷。当然，译者们翻译经验有限谴词造句难免会有出入或生涩之处，请读者批评指正，多多包涵。</p>

<p>感谢华章图书的编辑谢晓芳，及其耐心细致的编辑工作，她是我们见过的最有耐心的一位编辑，容忍我们一次又一次的延迟交稿，如果没有她这些可贵的品质，本书不可能出版。</p>

<p>感谢我们团队的小伙伴们，他们利用晚上的闲暇时光，帮助我们一起审读译稿，感谢公司给我们创造了一个开放宽松的学习实践环境，我们可以将书中所学传播到工作中，践行各种策略、方法和实践。</p>

<p>我们的小伙伴们：郑建琴，王刚，余鹰伟，周峰，凌建发，宓媛珊，吴恩平（排名不分先后），感谢你们。</p>

<p>译者</p>

<p>于杭州，
2014年下雪的春天
- End -</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[一群IT屌丝成为高富帅的故事 ——《孵化Twitter: 从蛮荒到IPO的狂野旅程》读书笔记]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2014/02/17/Hatching-twitter-reading-notes/"/>
    <updated>2014-02-17T15:31:00+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2014/02/17/Hatching-twitter-reading-notes</id>
    <content type="html"><![CDATA[<p>这是一本闲书，适合枕边阅读，看这本书，就像看电视剧一样，每个场景描述得就像真的出现在眼前一样，一群IT屌丝的欢声笑语与恩怨情仇。如果要给这本书一个更恰当的副标题的话，就是“一群IT屌丝成为高富帅的故事”。</p>

<p>作者也有意的在书中给每位角色给出前后反差的描写：</p>

<ul>
<li>Evan从一个小农场的小农民，成为身价数十亿美金的高富帅；一直心量想得多，就是对别人好，也不会说出来，典型的国内IT群里好男人的形像，理想是想做个好大哥；</li>
<li>Jack从一个邋遢，就算辞职也要戴鼻环的IT黑客，成为一个追求时尚装扮的商人；我觉得他是作者描写得最腹黑的一位；</li>
<li>Biz Stone最后为了Evan的职位而怒发冲冠，完全颠覆了老好人的形像；</li>
<li>Noah则从原来的闹腾的大男孩，如何变成了一位沉默的人，默默地注视，默默地离去；他应该是最不得志的人了。</li>
</ul>


<p>作者从几任CEO的维度来组织描写，下图是我从时间的维度给出的一个简介。</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2014-02-17-read-hatching-twitter/twitter.png" title="twitter" alt="Alt text" /></p>

<p>从书中总结的几点：</p>

<ul>
<li>千万不要和朋友一起创业，除非你们能一直Align彼此的想法；</li>
<li>什么创始人，什么技术并不重要，资本在公司才有至高的权力；</li>
<li>对立的想法，并不会阻碍孕育成功的产品；</li>
<li>成功的产品应该是集众人所长之大成；</li>
<li>资本是逐利的；</li>
<li>坚持自己的想法；</li>
<li>重视身边的副产品。</li>
</ul>


<p>这是最好的电影素材，如果搬上银幕，千万不要让我失望。</p>

<p>-End-</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Build CI Environment With Gerrit, Jenkins and Subverison]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2013/10/10/gerrit-jenkins-subversion-integration/"/>
    <updated>2013-10-10T11:31:00+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2013/10/10/gerrit-jenkins-subversion-integration</id>
    <content type="html"><![CDATA[<h2>1. Overview</h2>

<h3>1.1. Purpose</h3>

<p>This idea is addressed by Simon and I during discussion. And we found Andriod open source community is using this way for a long time. So I&rsquo;d like mark my practice notes here.</p>

<ul>
<li>Gerrit is <code>git</code> repository management tools, more external reference you can read about the benefits of <code>git</code></li>
<li>Gerrit provides good source code review web UI</li>
<li>Gerrit is easier to integrate with jenkins</li>
</ul>


<p>So, from developer perspective of view, he/she can focus on source code changing/implementation, no more interruption from process manager or quality manager. From process manager view, he/she can define the source code commit and review process easier via gerrit configuration. From quality manager view, he/she can easier get the source code and review quality metrics which via developed metrics system (cooperate with jenkins and gerrit through REST query API).</p>

<p>Of cause, if your organization still using subversion, you can use subgit to sync the changes between subversion and gerrit.</p>

<h3>1.2. Architecture</h3>

<p><img src="http://blog.zhangliaoyuan.com/images/2013-10-10-gerrit-jenkins-subversion-integration/Gerrit_Jenkins_Subversion_Inegration.png" title="Integration Architecture" alt="Alt text" /></p>

<p>Team can use subgit mirror the project to team owned gerrit server, and then team member clone the project to their local disk. Any changes making will be happen in local repository, after changes done. Developer can push the changes to remote repository (i.e., the gerrit server git repository). Once the changes is pushed to the server, gerrit will trigger jenkins to verify the changes (Compiling, unit testing, regression testing etc. CI jobs will be ran), and meanwhile, gerrit will send the review request mail to dedicated reviewer. After the reviewer approved the changes and jenkins verified okay, the source code changes can be merged into project master which is located in gerrit git repository. Otherwise, developer shall rework and push new patch again.</p>

<h2>2. Gerrit Deployment</h2>

<h3>2.1. Installation</h3>

<pre>
gerrit@gerrit-Workstation:~/gerrit$ java -jar gerrit-2.6.1.war init -d review_site
</pre>


<p>Once finish the installation of gerrit, it will be started automatically, or you can switch to <code>$(ROOT)/bin</code> folder, and execute command</p>

<pre>
gerrit@gerrit-Workstation:~/gerrit/review_site/bin$ ./gerrit.sh start
Starting Gerrit Code Review: OK
</pre>


<p>
to start it.</p>

<h3>2.2. LDAP Configuration</h3>

<p>To support the LDAP authentication, you have to change the gerrit configuration under <code>$(ROOT)/etc/gerrit.config</code>, so that, you can use the LDAP type to authenticate the gerrit login and git operates.</p>

<pre>
[auth]
        type = LDAP
        gitBasicAuth = true  #This option means user can push source via ldap authentication during execute git related comments.
[ldap]
        server = ldap://ldap-server-address:389 #fill yours
        username = cn=BOOTMAN_Acc,ou=SystemUsers,ou=Accounts,o=... #fill yours
        accountBase = ou=People,o=xxx #fill yours
        accountPattern = (uid=${username})
</pre>


<h3>2.3. Create a new project</h3>

<h4>Login the gerrit web UI</h4>

<p>Type the http address of gerrit service on browser, in this case, it&rsquo;s <a href="http://192.168.1.100:8081/" title="gerrit service">http://192.168.1.100:8081/</a>, sign in with your account which stored in the ldap.</p>

<h4>Create new project</h4>

<p>Create new project, and &ldquo;Rights Inherit From&rdquo; shall be &ldquo;All-Projects&rdquo;, it means current you created project configuration(such as access control) will inherit from &ldquo;All-Projects&rdquo; project, of cause, you can select inherit from empty, or define your project owned properties by yourself.</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2013-10-10-gerrit-jenkins-subversion-integration/create_new_gerrit_project.png" title="Create new project" alt="Alt text" />
Figure 1-1</p>

<p>After create this project, it means create a new project git repository under gerrit git repositories folder. In this case, the new project git repository is <a href="http://192.168.1.100:8081/gameoflife_java" title="project repository">http://192.168.1.100:8081/gameoflife_java</a>. You can clone this project in your local PC by execute this command.</p>

<pre>
client@client-Workstation:~/workspace$ git clone http://192.168.1.100:8081/gameoflife_java
Cloning into 'gameoflife_java'...
warning: You appear to have cloned an empty repository.
</pre>


<p>Now you have cloned the repository, because this repository is empty, so there is warning prompted.</p>

<pre>
client@client-Workstation:~/workspace/gameoflife_java$ git remote -v
origin  http://192.168.1.100:8081/gameoflife_java (fetch)
origin  http://192.168.1.100:8081/gameoflife_java (push)
</pre>


<h3>2.4. Client works</h3>

<p>As developer, the most of works are done in client site, since your local git repository will cooperate with remote gerrit git repository, we have to do some initial step firstly.</p>

<h5>Get the commit-msg which is used for generate the changed-id:</h5>

<pre>
client@client-Workstation:~/workspace$ cd gameoflife_java/
client@client-Workstation:~/workspace/gameoflife_java$ curl -o .git/hooks/commit-msg http://192.168.1.100:8081/tools/hooks/commit-msg
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  4276  100  4276    0     0   3515      0  0:00:01  0:00:01 --:--:--  4341
client@client-Workstation:~/tmp/gameoflife_java$ chmod u+x .git/hooks/commit-msg
client@client-Workstation:~/tmp/gameoflife_java$ 
</pre>


<h5>Configure the git user properties:</h5>

<pre>
client@client-Workstation:~/workspace/gameoflife_java$ git config remote.origin.push HEAD:refs/for/master
client@client-Workstation:~/workspace/gameoflife_java$ git config user.name erizhang
client@client-Workstation:~/workspace/gameoflife_java$ git config user.email eric.zhang@xxx.com
client@client-Workstation:~/workspace/gameoflife_java$ 
</pre>


<p>Okay, from here, you can execute general git command to commit and push your source code changes.</p>

<pre>
client@client-Workstation:~/workspace/gameoflife_java$ vim README.md 
client@client-Workstation:~/workspace/gameoflife_java$ git status
# On branch master
#
# Initial commit
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#   README.md
nothing added to commit but untracked files present (use "git add" to track)
client@client-Workstation:~/workspace/gameoflife_java$ git add .
client@client-Workstation:~/workspace/gameoflife_java$ git commit -m 'add README.md to initialize this repository'
[master (root-commit) 585f136] add README.md to initialize this repository
 1 file changed, 18 insertions(+)
 create mode 100644 README.md
</pre>


<p>Execute above command, we have already commit the source code changes in local git repository, and then we have to push them to our gerrit server git repository:</p>

<pre>
client@client-Workstation-Workstation:~/workspace/gameoflife_java$ git push origin
Username for 'http://192.168.1.100:8081': erizhang
Password for 'http://erizhang@192.168.1.100:8081': 
remote: Processing changes: new: 1, refs: 1, done    
remote: 
remote: New Changes:
remote:   http://192.168.1.100:8081/1
remote: 
To http://192.168.1.100:8081/gameoflife_java
 * [new branch]      HEAD -> refs/for/master
client@client-Workstation-Workstation:~/workspace/gameoflife_java$ 
</pre>


<p>Please notice that there is <code>remote:   <a href="http://192.168.1.100:8081/1">http://192.168.1.100:8081/1</a></code>, for this change, there is change-id generated, and developer can distribute this URL to reviewer for source code review. Let&rsquo;s open this link with our web browser:
<img src="http://blog.zhangliaoyuan.com/images/2013-10-10-gerrit-jenkins-subversion-integration/change_webpage.png" title="Change web page" alt="Alt text" /></p>

<p>Okay, reviewer or project owner can review this source code changes, approve the change and submit the change to master. Based on current basic configuration, only project owner and gerrit administrator have permission to approve the changes and submit the changes. In reality, the project process is not easy like that, we decide to nominate a group of people to take the key reviewer role of our project, only key reviewer can approve the final review.</p>

<h3>2.5. Create ReviewBoard group and access control</h3>

<h4>Create ReviewBoard group and add the members</h4>

<p>Login gerrit web UI with administrator, select &ldquo;People&rdquo; -> &ldquo;Create New Group&rdquo;
<img src="http://blog.zhangliaoyuan.com/images/2013-10-10-gerrit-jenkins-subversion-integration/create_reviewboard_group.png" title="Create ReviewBoard Group" alt="Alt text" /></p>

<h4>Access control of the new create group</h4>

<p>Select our created project, there is &ldquo;Access&rdquo;, click and edit it. &ldquo;Add reference&rdquo; for <code>refs/heads/*</code> and <code>refs/meta/config</code> separately, see below diagram illustrate:
<img src="http://blog.zhangliaoyuan.com/images/2013-10-10-gerrit-jenkins-subversion-integration/add_label_review_access_control.png" title="Add Lebel Review Access permission to ReviewBoard" alt="Alt text" /></p>

<p>Till now, we have create new Group named &ldquo;ReviewBoard&rdquo;, and all members in this group have &ldquo;Label Review&rdquo; access control, in another words, they can approve the source code review. More information about access control, you can refer the gerrit official document <a href="http://gerrit.googlecode.com/svn/documentation/2.1/access-control.html" title="access control">Access Control</a> section.</p>

<h2>3. Jenkins deployment</h2>

<h3>3.1. Install Jenkins</h3>

<pre>
jenkins@jenkins-Workstation:~/gerrit/jenkins$ wget -q -O - http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key | sudo apt-key add -
jenkins@jenkins-Workstation:~/gerrit/jenkins$ sudo sh -c 'echo deb http://pkg.jenkins-ci.org/debian binary/ > /etc/apt/sources.list.d/jenkins.list'
jenkins@jenkins-Workstation:~/gerrit/jenkins$ sudo apt-get update
jenkins@jenkins-Workstation:~/gerrit/jenkins$ sudo apt-get install jenkins
</pre>


<h3>3.2. Start jenkins</h3>

<p>If you want to start jenkins with another port rather than default port 8080，you can modify below configuration file, and set the httpPort to your prefer:</p>

<pre>
jenkins@jenkins-Workstation:~$ sudo vim /etc/default/jenkins
</pre>


<p>Start jenkins:</p>

<pre>
jenkins@jenkins-Workstation:~$ sudo /etc/init.d/jenkins start
 * Starting Jenkins Continuous Integration Server jenkins                                                   [ OK ]
jenkins@jenkins-Workstation:~$
</pre>


<h2>4. Gerrit Trigger</h2>

<h3>4.1. Install the <code>Gerrit Trigger</code> Plugin</h3>

<p>Open your browser, and type the jenkins address, here we use <a href="http://192.168.1.200:8080" title="Jenkins">http://192.168.1.200:8080</a>, in the dashboard, choose &ldquo;Manage Jenkins&rdquo; -> &ldquo;Manage Plugin&rdquo;, and then you can find the <code>Gerrit Trigger</code> in the &ldquo;Available&rdquo; tab.</p>

<blockquote><p><em><strong>NOTE</strong>: If there is empty in the &ldquo;Available&rdquo; tab, maybe you should select &ldquo;Advanced&rdquo; tab, and click &ldquo;Check Now&rdquo; which locates the right-bottom of the page. Of cause, if you encounter the problem of connect internet, perhaps you have to configure the proxy under &ldquo;Advanced&rdquo; tab as well.</em></p></blockquote>

<p>Select the plugin, and install without restart, the process which shows like this.</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2013-10-10-gerrit-jenkins-subversion-integration/jenkins_plugin_success_installed.png" title="Install Jenkins plugin successfully" alt="Alt text" /></p>

<h3>4.2. Generate jenkins needs ssh-key for <code>Gerrit Trigger</code> usage</h3>

<p>Since jenkins will operate gerrit via SSH protocol, to Gerrit, there will be a gerrit user account represents jenkins. So, this step is generate rsa key first.</p>

<pre>
jenkins@jenkins-Workstation:/var/lib/jenkins$ sudo ssh-keygen                                   -t rsa -C "jenkins@xxx.com"
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa): /var/lib/jenkins/.ssh/i                                  d_rsa
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /var/lib/jenkins/.ssh/id_rsa.
Your public key has been saved in /var/lib/jenkins/.ssh/id_rsa.pub.
The key fingerprint is:
8d:e6:0c:42:cf:3b:d6:52:63:e8:a0:d7:9a:7b:5f:bd jenkins@xxx.com
The key's randomart image is:
+--[ RSA 2048]----+
|                 |
|                 |
|    .            |
|   . o . o       |
|    o = S .      |
|   . = X . .     |
|  . . B + . .    |
|   . +.o .   .   |
|    +o ..   E    |
+-----------------+
</pre>


<h3>4.3. Create <code>jenkins</code> user account for jenkins</h3>

<p>In jenkins server, generate the jenkins rsa public key by this command:</p>

<p>Create a new gerrit user <code> jenkins </code></p>

<pre>
jenkins@jenkins-Workstation:~/gerrit/review_site/bin$ ssh -p 29418 erizhang@192.168.1.100 gerrit create-account --ssh-key - jenkins < /var/lib/jenkins/.ssh/id_rsa.pub
Enter passphrase for key '/home/erizhang/.ssh/id_rsa':
jenkins@jenkins-Workstation:~/gerrit/review_site/bin$ 
</pre>


<p>Now we have create a new gerrit account <code>jenkins</code>, this account will be used for the gerrit automatically trigger jenkins job purpose. Of cause, you can use <code>gerrit set-account</code> command to change the or add the account properties.</p>

<h3>4.4. Configure <code>Gerrit Trigger</code></h3>

<p>Select &ldquo;Manage Jenkins&rdquo; &ndash;> &ldquo;Gerrit Trigger&rdquo;, you can enter into the <code>Gerrit Trigger</code> pages. Fill your Gerrit server host address, user name which represents jenkins to access gerrit, ssh keys etc., and click &ldquo;Test Connection&rdquo;. It will show success or not. See below diagram shows.</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2013-10-10-gerrit-jenkins-subversion-integration/jenkins_gerrit_trigger_configure.png" title="Configure Gerrit Trigger" alt="Alt-text" /></p>

<p>After then, save your settings and restart the connection in the &ldquo;Control&rdquo; section at the bottom of the page:</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2013-10-10-gerrit-jenkins-subversion-integration/gerrit_trigger_control_restart.png" alt="Alt-text" /></p>

<h3>4.5. Add <code>Label Verified</code> Access Control to <code>jenkins</code> account</h3>

<p>Firstly, please make sure, there is <code>Label Verified</code> of the project access control, by default, gerrit does not have this access control. You can refer the post <em><a href="http://blog.bruin.sg/?p=171" title="Add Label Verified">How to edit the project.config for all projects in Gerrit</a></em> to implement it. Here we add the &ldquo;Label Verified&rdquo; access control, and then any projects which inherited form <code>All-Projects</code> will have this access control label.</p>

<pre>
client@client-Workstation:~/tmp/a$ git init
Initialized empty Git repository in /home/erizhang/tmp/a/.git/
client@client-Workstation:~/tmp/a$ git remote add origin ssh://erizhang@192.168.1.100:29418/All-Projects
client@client-Workstation:~/tmp/a$ git fetch origin refs/meta/config:refs/remotes/origin/meta/config
remote: Counting objects: 4, done
remote: Finding sources: 100% (4/4)
remote: Total 4 (delta 0), reused 0 (delta 0)
Unpacking objects: 100% (4/4), done.
From ssh://192.168.1.100:29418/All-Projects
 * [new branch]      refs/meta/config -> origin/meta/config
client@client-Workstation:~/tmp/a$ ls
client@client-Workstation:~/tmp/a$ git config user.email eric.zhang@xxx.com
client@client-Workstation:~/tmp/a$ git config user.name erizhang
client@client-Workstation:~/tmp/a$ ls
client@client-Workstation:~/tmp/a$ git co meta/config
Branch meta/config set up to track remote branch meta/config from origin.
Switched to a new branch 'meta/config'
client@client-Workstation:~/tmp/a$ ls
groups  project.config
</pre>


<p>Open <code>project.config</code>, and append below lines into the file.</p>

<pre>
[label "Verified"]
       function = MaxWithBlock
       value = -1 Fails
       value =  0 No score
       value = +1 Verified
</pre>


<p>Execute below commands, to update the configuration.</p>

<pre>
client@client-Workstation:~/tmp/a$ git commit -a -m 'add verified label'
[meta/config 09b3910] add verified label
 1 file changed, 6 insertions(+)
client@client-Workstation:~/tmp/a$ git push origin meta/config:meta/config
Counting objects: 5, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 395 bytes, done.
Total 3 (delta 1), reused 0 (delta 0)
remote: Resolving deltas: 100% (1/1)
remote: Processing changes: refs: 2, done
To ssh://erizhang@192.168.1.100:29418/All-Projects
   7fa7742..09b3910  meta/config -> refs/meta/config
client@client-Workstation:~/tmp/a$
</pre>


<h3>4.6. Create <code>VerifyBoard</code> Group and add <code>jenkins</code> user account in this group</h3>

<p>Can follow section 2.5 to implement it.</p>

<h3>4.7. Create the jenkins job</h3>

<p>If you have already finished above steps, now you can follow the <a href="https://wiki.jenkins-ci.org/display/JENKINS/Gerrit+Trigger" title="Gerrit Trigger">Gerrit Trigger official guideline</a> to create the jenkins job. I&rsquo;m not going to repeat it in this post again.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Why We Need Visual Task Board]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2013/08/30/why-we-need-visual-task-board/"/>
    <updated>2013-08-30T11:31:00+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2013/08/30/why-we-need-visual-task-board</id>
    <content type="html"><![CDATA[<p>The department which I&rsquo;m working on, it&rsquo;s thought be the first team adopted Scrum in China, so our people mostly seems ourselves is the Scrum forerunner in China althrough there might be another place is ahead of us. Year and year, day after day, we did various of Scrum practices, And while the R&amp;D is growing in size, and with people change in the organization, people have been forgetting the rationale behind these practices, and thinking Scrum is such practices, such practices are Scrum. But one day, we were questioned by our naive boy: Why?</p>

<p>Today, let’s clarify why we need visual task board? Why we not use excel instead, or some on-line task management tools such like Trello?</p>

<h2>Understanding the team situation likes looking at a picture</h2>

<p>Pasting the task on the wall with different priorities, moving forward accord to the progress. The task will be moved from “TODO” column to “DONE” column, it’s easier understand the team work iteration item progress. If we at a time point, the most of task cards is still under the “TODO” column, it means we have a lot of work to do; if the most of task cards is under “DONE” column, we can understand it’s not far from our target.</p>

<p>“IN PROGRESS” reflects team daily work. If too many tasks are under this column,  it means there is something wrong about the task assignment – either the task estimation has some problems or team is too optimistic. The total size of the tasks under “IN PROGRESS” shall be mostly equal as the team daily capacity.</p>

<p>Of cause, we can use various of color cards to represent the regular planning tasks or interrupting tasks, based on the interrupting tasks number, we can understand how well we did sprint planning.</p>

<p>Adding “BLOCKING” column, we can clearly find out how many tasks are blocked by other teams. We can make various of changes to task board based on team needs, task board shall illustrates the team work situation clearly. Team member just raise his/her head, he/she can understand how well we work on our task, the progress is leading, or delay. Team work is transparent for everyone, any one in any time can understand team situation from task board.</p>

<h2>Programmers are “lazybones”</h2>

<p>I remember one words said: the innovators are lazybones. Because they are lazy, so they are motivated to innovate something instead of hard working. And later, this words has been evolved to: the high IQ people is lazybones. It comes “Innovators are high IQ people”. And now, programmers seems themselves as high IQ people, so programmer shall play as lazy style. Innovator == lazybones; innovator == high IQ people; high IQ people == lazybones è if you want to make self look like high IQ people, play lazybones, so that’s the logic. Do you know the question in Quora: <a href="http://www.quora.com/Do-intelligent-lazy-people-achieve-more-in-life-than-intelligent-active-people/answer/Stefan-King?srid=hTa3&amp;share=1" title="Quora question">Do intelligent lazy people achieve more in life than intelligent active people?</a></p>

<p>So, to lazybones, require him/her to look for a document and open it, it’s very difficult, because he/she thinks there were too many steps. We can image that if we require lazybones to read a document which located on a website:</p>

<ol>
<li>Visiting the website</li>
<li>Looking for the document</li>
<li>Downloading the document</li>
<li>Opening the document via MS office (WTF office, why you are so slow)</li>
<li>Reading, and there are page up and page down</li>
</ol>


<p>Same reason, how to make lazybones care about the task board? If we use excel to keep the tasks, what the situation will be:</p>

<p>During the daily meeting, Scrum Master opens the laptop, and then all team member gather around the only 15 inch laptop screen, you guys open your big eyes as bigger as possible, and focus on only 10 font size words to make the task updating. In another scenarios, you do not expect the lazybones never will open this document any more, since opening this excel will cost too many steps – and then in time task updating is a problem.</p>

<p>If we have task board, all tasks are written on the cards, and they&rsquo;re clearly pasted on the wall. You just give a sight, you can find out the task, for the task updating, you only need to move the cards. See, easy.</p>

<h2>It’s not only a wall, it’s team flag</h2>

<p>How prove team existence? Name, flag.  Every day, all team member gathering under the wall, it’s solid entity, you will found that, this wall represents the team. Team member will think this is our team platform, we have something to do on this place. So during we create the task board, it means we are creating the team flag.</p>

<h2>End</h2>

<p>I can understand, you prepare a lots of reason here to prove why you need excel to keep the task list. That’s fine, give your comments below, let me understand your reason first. I just want to say, the confident team, ready to show muscle. Be a “lazy” and high efficiency team, start from build a visual task board.</p>

<ul>
<li>EOF -</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[程序员上网扫盲]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2013/07/26/how-programmer-surf-internet/"/>
    <updated>2013-07-26T11:31:00+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2013/07/26/how-programmer-surf-internet</id>
    <content type="html"><![CDATA[<p>最近常常被很多朋友问到这样的问题：</p>

<ul>
<li>你们是用什么工具做了这么炫的presentation？</li>
<li>你们从哪里找来这么标准的回答，我提的问题就是那个？</li>
<li>你们从哪里了解到这么好玩的东东？</li>
<li>你们怎么可以认识到这么多的大牛？</li>
<li>你们都从哪学来这么多的知识呀？</li>
</ul>


<p>我们总是告诉他们：</p>

<ul>
<li>我用<a href="http://prezi.com/" title="prezie.com">prezi</a>做的展示，酷吧，你也可以。</li>
<li>我常常登录<a href="http://www.quora.com/" title="quora.com">quora</a>和<a href="http://stackoverflow.com/" title="stackoverflow.com">stackoverflow</a>，所以我明白问问题的技巧和查找答案的方法。</li>
<li>我用<a href="http://feedly.com/" title="feedly.com">feedly</a>订阅了很多的RSS，并且分类，定期阅读，开阔了我的眼界。</li>
<li>我会“科学上网”，在<a href="http://twitter.com" title="twitter.com">twitter</a>上follow了@codinghorror @mfeathers @KentBeck @unclebobmartin 等很多大牛，我知道他们在干嘛，跟他们互动，大牛没有想的离得那么远。我们在<a href="http://github.com/" title="github.com">github</a>上fork大牛的项目，给他们提pull request，离大牛更近了。</li>
<li><a href="https://www.coursera.org/" title="coursera.org">coursera</a>，<a href="https://www.codeschool.com/" title="codeschool.com">codeschool</a>是我常去的网站。</li>
</ul>


<p>总之，问题林林总总，总是关心我们工作及获取信息的方式。首先，应该肯定提出问题的这些朋友还保持着程序员的猎奇的心态，对未知领域的好奇心，正是这些好奇心，激励着我们往前走，又有多少人连这点好奇心都没有了呢？而从另一个角度，我们又感到一丝丝的担忧，IT行业在互联网上发生翻天覆地的变化，而我们很多朋友却依旧固步自封，原地不动。</p>

<p>我们应该庆幸生活在这个时代，这样的时代互联网给我们提供了取之不尽的资讯，但是，我们又多么不幸地生活在了这样的时代，这样的时代可以让一个中学生迅速成为你的竞争对手，成为程序员的门槛已经不高，10+程序员已经展露头角。不学习，总会被取代掉。鉴于此，朋友建议我做对程序员上网做做扫盲，对很多人来说，这些网站都是“老地方”，但我相信同样会有很多人会认为这是个新去处。</p>

<h2>开源社区Github</h2>

<p>Sourceforge，google code离我们越来越远，而github却离我们却越来越近。这家公司虽然地处湾区，在地理位置上来说，与我们隔着一个太平洋的距离，可是<a href="http://github.com" title="github">github.com</a>却成为每一个geek必去的网站，越来越多的开源项目进驻，越来越多的公司用它来做项目开发。这是一家提倡社交化开源，社交化开发的公司，该公司只有一个员工有一个固定的title，那就是CEO，其他员工的title都是经常性的变更，有时叫“黑暗骑士”，有时叫“终结者”，员工遍布全球，办公地点有的在家里，咖啡店，Office，而有的则可能在旅行的路上。</p>

<p>软件开发已经没有传统的地域限制，github提供了这样的一个技术平台，提供社交化的虚拟社区，人人可以提交代码，人人可以review代码。要开展一个项目，你只需在网站上建一个repository，剩下的就去邀请那些极客了，给他们一根网线，他们会用各种名词&#8221;clone&#8221;，&#8221;fork&#8221;，&#8221;pull request&#8221;跟你交流。如果有一天，你听到一个人跟你讲，请fork一下我，千万别感到奇怪。你需要掌握的知识就是编程和git的使用，很高兴，互联网给了免费的图书让你<a href="http://git-scm.com/book/zh" title="Pro Git">学习git</a>。据说，现在很多大公司会通过github上的信息，网罗他们需要的程序员，又一个<a href="http://www.guokr.com/article/437170/" title="How Big Data Is Playing Recruiter for Specialized Workers">大数据的案例</a>。</p>

<p>又据说，现在美国白宫也在正尝试通过github的协作方式来完成一些文章和政策文档的编撰工作。白宫已经开始了，你还等什么呢？登录<a href="http://github.com" title="github">github.com</a>，fork我吧。</p>

<h2>问答类网站 Stackoverflow &amp; Quora</h2>

<p>记不记得上世纪90年代末本世纪初的时候，很多程序员会泡在<a href="www.csdn.net" title="csdn.net">CSDN</a>论坛上，回答各种问题，积累专家分。只是有点可惜，这家公司不知道自己应该做什么，又是做博客，又是办杂志，又是搞社区，据说现在也倒腾了一个github-like类网站。随着<a href="http://en.wikipedia.org/wiki/Eternal_September" title="Eternal September">永恒的九月</a>的现象，越来越多的低质量问题和答案充斥其中，后来很多人选择离开这样一个技术讨论平台。</p>

<p>而<a href="http://stackoverflow.com" title="stackoverflow.com">Stackoverflow</a>就是这样一个成功的网站，这是一个属于程序员的网站，由大牛 @codinghoner <a href="http://en.wikipedia.org/wiki/Coding_Horror" title="Jeff">Jeff Atwood</a>开发的一个供程序员提问及回答讨论的网站，你可以在这里提出关心的技术问题，只要分类OK，很快就会有人给你解答，如果对一些问题感兴趣，你可以收藏该问题。专家分积累到一定程度，会给你一个勋章，这吸引着越来越多高质量的问题和答案，以致于现在流传着这样一句话：世界上只有两种开发模式，到github上clone代码，或者到stackoverflow上复制代码。</p>

<p>这是一个来自<a href="http://stackoverflow.com/questions/184618/what-is-the-best-comment-in-source-code-you-have-ever-encountered" title="classical-q-a">经典stackoverflow的问答</a>，看过之后相信你会爱上这个网站。现在很多公司的招聘信息上已经明确要求应征者提供其github和stackoverflow帐号，这可比大学考试分数靠谱多了。</p>

<p><a href="http://quora.com" title="quora.com">Quora</a>相比stackoverflow就是另一种风格。同样是问-答类网站，Quora涉及的问题会更大一些，stackoverflow会深入技术细节。但两者的相似之处都是因为吸引了很多的大牛，和保持一贯高质量的问答，这是他们成功的经要。</p>

<h2>在线教育 Coursera &amp; Codeschool</h2>

<p>我们常常吐槽，说国内没有一所好的大学，没有碰到好的老师，一切如此糟糕境遇的原因都是他们：我是一块好的璞玉，没有人打磨，所以就是这样。</p>

<p>如果你还在抱怨这些原因的话，那你大可不必了。虽然你这辈子可能鲜有走出国门，走进更高的学府的机会，而网上公开课程给你提供了这些便利。且不说风靡的哈佛公开课程《公平与正义》等视频在互联网上到处可见，更为专业性的网上课程网站<a href="http://coursera.com/" title="coursera.com">Coursera.com</a>提供了更为专业的服务。网站会提前给出即将开展的课程安排，用户根据自身需要，选择课程，在安排的时间段学习课程，网站提供了视频，slides，录音，完成老师布置的作业，你还可以跟老师互动，向老师提问（当然，这很难做到逢问必答）。在一定的时间内完成课时，并且作业达到一定分数，课程结束后，你会收到一份证书。据说这份证书目前比某些大学的毕业证更靠谱。如果你过不了语言关，不要紧，有些课程的视频配有中文字幕，你的学习过程就像看美国大片。此外，<a href="http://coursera.yeeyan.org/" title="coursera.yeeyan">译言网上中文课堂</a>是译言网与Coursera合作最近刚上线的项目。</p>

<p>记得去年参加了斯坦福的<a href="http://en.wikipedia.org/wiki/Andrew_Ng" title="吳恩達">Andrew Ng</a>教授的一个课程<a href="https://www.coursera.org/course/ml" title="machine learning">Machine Learning</a>，因为吸引人很多人的参课，首期就超过10万人注册课程，并且反响异常热烈，该课程获得了去年coursera年度最受欢迎课程的荣誉。你想，一下子你就多了10万个同学，这是什么样的概念，多选几门课程，你同学数都可达百万级。</p>

<p>做为程序员，要想精通多门开发语言的Hello World程序，只要花上一个小时，要想精通多门语言的<a href="http://en.wikipedia.org/wiki/Conway%27s_Game_of_Life" title="GameOfLife">Game of Life</a>程序，只要花上一周。网上编程教育网站<a href="http://codeschool.com/" title="codeschool.com">codeschool</a>就是这样一个网站。它提供多种开发语言让你选择，并且由你选择学习路径，入门，进阶，高级等等，一应俱全。就Ruby语言来说，有Ruby Basics， Starting Rails， Advanced Ruby， Rails Edge， Railstesting，Rails Best Practices。足不出户就可以成为开发高手。如果你真想成为大拿，现在就登录这些网站注册课程吧。</p>

<h2>RSS订阅</h2>

<p>记得前几个月，当google说要在七月份把google reader关掉的时候，有许多有阅读RSS订阅的人焦虑了一阵子。不要告诉我你不知道有什么是RSS订阅，如果真不知道，请登录到google.com在查询栏输入“什么是RSS订阅”。如果你告诉我你不用google，而是用baidu，那你就活该当个outer。</p>

<p>现在好了，<a href="http://feedly.com/" title="feedly">feedly</a>和<a href="http://digg.com/" title="digg.com">digg</a>都提供google reader的平滑过度，而且提供了很好的用户体验。像feedly还提供了免费的Andriod和iOS应用，Windows Phone上也有nextGen Reader来支持feedly，这难道还不够吗？</p>

<p>有人会说，光有工具还不够，内容呢，哪里来？我获取内容的途径一般来自<a href="https://news.ycombinator.com/news" title="yc">Hacker News</a>, <a href="http://www.reddit.com/" title="reddit.com">Reddit</a>，还有我在社交网上follow的那些大牛分享的网站，天天积累，越来越多。不要告诉我你不知道Hacker News，这个网站的founder，可是大名鼎鼎的<a href="http://en.wikipedia.org/wiki/Paul_Graham_%28computer_programmer%29" title="Paul.G">Paul Graham</a>，《黑客与画家》的作者，著名的天使投资人，最早以lisp程序员而闻名。</p>

<p>我一直认为，在信息爆炸的时代，能通过人肉再过滤一层的信息会更值得读，时间有限，你不可能什么都读，就像看电影一样，我们一般都选择得分高的电影，或者朋友推荐的。像Hacker News和Reddit就是帮我们排序的。</p>

<p>现在手机上还有一款不错的软件，叫做flipboard，它收集了各路信息，然后帮你汇总分类，也是不错的一个神器。如果你还在担心英文阅读的困难，我可以建议两个途径：</p>

<ul>
<li>恶补英语，常常读，让看英文资料成为一种习惯</li>
<li>如果你真的在语言上不可救药，那看中文网站吧，现在有很多志愿者把他们认为不错的资料翻译成中文，如<a href="http://www.yeeyan.org/" title="yeeyan">译言网</a>，<a href="http://www.aqee.net/" title="aqee.net">外刊IT评论网</a>。也有汇集牛人博客的网站，如<a href="http://www.udpwork.com/" title="udpwork.com">IT牛人博客聚合</a>。</li>
</ul>


<p>每天花上1个小时做订阅的阅读，当这成为一种习惯，你也会成为信息的受益者。当然，你的目标要成为一位分享者，只有分享才会让我们的时代更加丰富多彩。</p>

<h2>编程训练平台 Cyber-dojo &amp; oDesk</h2>

<p>编程是一项技能，所谓拳不离手，曲不离口，做为训练自己的编程能力，<a href="http://cyber-dojo.com/" title="cyber-dojo.com">cyber-dojo</a>提供了这样的一个平台，你只需setup起来，获得一个ID，就可以选择一门开发语言和练习题目，开始你的编程训练。我们可以以一个Scrum团队一起来完成，以TDD的形式，成员之间乒乓交换，即先一个人pass单元测试，重构代码，再写一个failed掉的单元测试，这时另一个人接手重复上述过程，一直不停换人，直到完成整个题目。</p>

<p>我想，一群人能在一起写写代码，不停地交换彼此的想法，编程技能提高得肯定很快。如果开始阶段不是太容易掌握活动的引导，找一位好的引导人也是一个不错的选择。</p>

<p>其实<a href="http://www.odesk.com/" title="odesk.com">oDesk</a>不完全是一个训练平台，它的目的是用于软件的分包和承包，你可以把自己的个人信息和技能写上，给出你需要的佣金，然后参加项目的承包竞标。这是一个非常好玩的事情，非常接近真实生活中的招投标过程，当然，这里的招投标也是真实的。如果你准备好了，你可以试试自己的价值，利用业余时间参加一些这里的项目也是一件不错的事。</p>

<p>我听说过两件oDesk的趣事，一件是分包的事。据说一位牛人，他在他们公司的绩效特别好，交待给他的事，他都很好地完成掉了，所以，他工资特别高，但最后发现，他的工作都被他在网上分包给了中国的一些开发者。还有一件是关于承包的，有一位程序员决定环球旅游，然后他带好了电脑，还有上网的辅助设备，在旅途上，边看风景，边在oDesk承包项目，而且赚到了比在前公司工作还多的收入。</p>

<h2>在线协作平台 Google Doc(Drive)，Google Hangout， Dropbox, Trello</h2>

<p>除了github可以提供一套协作的流程外，Google Doc也或者叫Drive，也是个好东西，现在我们几个朋友之间常用这个工具来协作完成一些slides，文档，或者excel。还记得最早用Google Wave的时候，现在Google Doc跟它相比，可是巨大的飞跃。此外，我们还用<a href="http://www.dropbox.com" title="dropbox">Dropbox</a>来存储我们需要的东西，如做远程的git repository，做一些文稿的协作撰写。</p>

<p>当我们在协作过程中遇到任何问题需要交流的时候，Google Hangout提供了视频会议功能。而这些都是免费的服务，我们用Gmail收发邮件，Google Calendar做日程安排。一切都自然而流畅。</p>

<p>如果你的团队是用Scrum或者Kanban之类的开发模式，需要用到团队的任务的Backlog的话，那么<a href="https://trello.com/," title="Trello.com">Trello</a>将会是一个不错的辅助工具。你能通过它定制列表，如你可以定制一般Scrum的列表：TODO, In Progress, Done等，也可以定制Kanban的列表：User Story，设计，编码，测试等互为依赖的状态列表。另外，你团队成员的状态也会显示在上具上，你可以清楚地知道谁在负责哪个任务，也可以即时地与之联系。</p>

<p>除之此外，作为程序员，你可以在<a href="https://coderwall.com/welcome" title="Coderwall.com">coderwall</a>上把你的Profile建立起来，它会根据你在github上的项目和开发语言，给你列出一枚枚徽章。然后与朋友或同事在coderwall上建立团队，我们目前给公司在coderwall上建了一个团队，目前全球排名已经到了七百多名，如果你会加入的话，我们的排名会更靠前。</p>

<h2>社交网站 twitter, facebook, linkedin, glassdoor, ifttt</h2>

<p>这是最不需要分享的章节，只是我们生活在四周砌满高墙的国家，所需要做的只是“科学上网”，那么你听说过fqrouter, goagent吗？follow对人也很重要，我记得有位朋友跟我讲，他的微博里都是公知和五毛，天天吵，烦死了。我跟他讲，因为你本身想成为公知或五毛，所以才会有那么多的公知和五毛在他的微博里，如果你不想要他们的争吵，unfollow他们，帐号在你手里。</p>

<p>还有，你知道在什么时间发的言会被更多人阅读吗？你知道你的哪些粉丝最有影响力吗？你知道你的粉丝的活跃程度吗？因为你是个程序员，你所要做的就是掌握这些社交网站的API，写下一个应用，所有数据都会出来，是不是很有意思。另外，你有ml的能力(machine learning，不要误解)，可以学习你的粉丝或好友的行为，这时，你可以合理安排好你上微博的时间。会突然发现，生活变得与众不同。</p>

<p>不要沉迷社交网站，不要让其成为朋友之间唯一的沟通渠道，让朋友变成网友。一直以来，我不太愿意上QQ，从大学毕业戒掉QQ快10年了，原因是一上QQ，很多好友会向你说Hello，而你不得不客气地回复他们，被打断多次，之后只要我再上QQ，我都保持潜水的状态。上周我做过一个实验，我把QQ以在线的形式让它显示在那，我想统计一下我会收到多少打断，除了第一天上午收到四个好友的Hello，到第二天只有1个给我Hello，第三天，没有人再理我了，我并没有我自己想像的重要。:)</p>

<p>所以，当别人习惯了你的状态，你就不会显得那么重要了，不要总是打开微博看刚发出去的微博有多少@，有多少评论，只有不停地提高发出去的信息质量，@和评论就会多，而多了之后，当你习惯了，也就没那么重要了。</p>

<p><a href="https://ifttt.com" title="ifttt.com">ifttt</a>却是更高级的上网技，它是if this then that的缩写，this指的是触发行为，that是被触发的行为。也就是说，你在这一个网站上做的一个具体的行为，会触发另一个网站的行为。比如，我想在feedly但凡我mark成shared的文章，都需要分享在twitter上，那么这里的this就是指的在feedly上mark成shared，而that就是指的在twitter上发推。用户可以在ifttt上定制自已需要的触发器，目前该网站支持绝大多数热门的应用和社交网站的服务。到时你可就可以通过它管理多个社交网站了，而不需要在多个网站之间copy-paste。</p>

<h2>BFD还是DFD，时间在哪里</h2>

<p>大哥，信息太多了，我学习是广度优先还是深度优先呢？好问题。一般来讲，我会先BFD来一趟，发现热点，然后DFD，通过<a href="http://www.wikipedia.org/" title="wikipedia.org">Wikipedia</a>深入下去，再找书来读。上次我在微博上做了一下调查，大多数朋友都是BFD。</p>

<p>时间怎么安排，上班的时候干项目，下了班还被项目干(支持电话不断)，还要带小孩，陪老婆，没时间啦。我记得有次在google buzz里跟一些朋友讨论过这个话题。大体上是晚上回家只陪小孩，和小孩一起睡，早上比小孩早起，做阅读。班车上，地铁里看RSS订阅，把所有碎片都用起来。其实看起来很难，习惯了应该也就这样，还记不记得上中学那会儿，早上要出操，还有上早自习，那时是怎么过来的？最近流传着<a href="http://tech.ifeng.com/internet/detail_2013_07/26/27938213_0.shtml" title="12位早起的IT大佬">12位早起的IT大佬</a>的段子，不是要求大家成为大佬，而是我们不能光看到别人的光芒，而忘了他的付出。我记得还有一篇文章讲<a href="http://www.readability.com/read?url=http://www.fastcompany.com/3000619/what-successful-people-do-first-hour-their-work-day" title="first-hour">成功人士工作的第一个小时都干什么</a>，同样值得学习。</p>

<h2>结语</h2>

<p>写得越多，越发现停不下来，因为还有很多好用的东西值得写下来，如分享幻灯片的<a href="http://www.slideshare.net" title="slideshare.net">slideshare</a>，可以做出很炫幻灯片的<a href="http://www.prezi.com" title="prezi">prezi</a>，常常收听的<a href="http://www.ted.com" title="ted">TED</a>等等。随着国内的互联网企业的发展，也越来越多的中文资讯网站办得越来越好，像豆瓣，36氪，果壳等等。我们所需要做的，只是定好目标，合理安排好时间。另外，圈子很重要，与肝胆人共事，从无字句处读书，你身边的朋友会是你学习的老师，他们follow什么样的人，他们读什么样的文章，他们怎么样安排生活，都是你参考学习的对象。我很开心认识了这么多的朋友，他们告诉了我很多不知道的好玩意儿，教会我“科学上网”，我才能写下上面那么多的废话。</p>

<p>要成为码农不难，要成来好的程序员不简单，先让自己不out，从现在开始。:\</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Speaking Codermetrics in ScrumGathering Shanghai 2013]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2013/07/08/codermetrics-in-scrumgathering/"/>
    <updated>2013-07-08T11:31:00+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2013/07/08/codermetrics-in-scrumgathering</id>
    <content type="html"><![CDATA[<p>因为一篇post &ndash; <a href="http://blog.zhangliaoyuan.com/blog/2013/04/18/why-i-translate-codermetrics/" title="Why we translate Codermetrics">我为什么翻译《程序员度量》</a>，受邀参加Scrum Gathering Shanghai 2013的活动，话题是《程序员度量》。说真的，对这个话题我没有太大的自信，很容易触到一部分人的神经，而我本身又是一个不太善于争论的人。谢谢孙妮和老窦的鼓励。我决定从另外角度来说程序员度量的这件事——从我们之前的失败案例看起（起码从我的角度是这样）。我想从这样的角度会引起更大的共鸣，让大家明白其中的种种。作为一种反思的素材供大家参考，这是有帮助的。</p>

<iframe src="http://www.slideshare.net/slideshow/embed_code/23992242 " width="595" height="446" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC;border-width:1px 1px 0;margin-bottom:5px" allowfullscreen></iframe>


<p></p>

<p>现场的反映超出了我的预期，认识到有很多的朋友在关注这个问题，也有的朋友正在经历类似的煎熬和困惑：</p>

<ul>
<li>短期的激励无法满足长久的发展</li>
<li>KPI来限制团队或成员的工作行为，发现长久之后，丢失了一个研发团队本应有的激情和创新</li>
<li>绩效考核</li>
<li>度量的数据无法收集，或无法保证数据的有效性及一致性</li>
<li>是否需要花大量的精力来做这个事情</li>
</ul>


<p>可能持反对意见者从这些问题会立刻得出这样的结论：度量方法害死了。</p>

<p>我本身亲历过这样的过程，而且很有幸多经历了几个角色，能更多地有同理心地去思考这些问题。如果真的需要度量，是否可以从几个方面做一些改进：</p>

<ul>
<li>不做排名比较</li>
<li>不做限制工作行为的事</li>
<li>只获取团队动态的洞察力，用于管理者对团队的认识及发展调整</li>
<li>只做对你可以控制的面的度量，限定度量的范围</li>
<li>从你开始一个度量，也从你结束一个度量，不留下给别人利用你的度量耍流氓的机会。A制定度量的时候是为了获取团队动态，而B可能就会用来做团队排名。</li>
</ul>


<p>说多无益，只是想请大家审慎地做出对人的度量这回事，目的和策略的不同，同样的事情，最后出来的结果是不同的。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Bee Watcher]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2013/06/25/bee-watcher/"/>
    <updated>2013-06-25T17:31:00+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2013/06/25/bee-watcher</id>
    <content type="html"><![CDATA[<p>之前与<a href="http://www.weibo.com/u/1431854415" title="Terry's Weibo">Terry</a>一起聊天，聊到一个叫做<a href="http://www.drseussart.com/details/illustration/beewatcher.html" title="The Bee Watcher">Bee Watcher</a>的故事，觉得挺有意思的。话说，一位农场主为了提高蜂蜜的产量，他在资深顾问的建议下，请了一位看蜂人(Bee Watcher)，看蜂人的任务就是监督蜜蜂采蜜，以此来提高产量。可是实际情况是，蜜蜂并没有因为有了看蜂人的存在而改变采蜜的方法，它们还是按部就班的从一朵花飞到另一朵花，飞来飞去忙个不停。一年下来，产量没有提高，农场主认为产量没有提高的原因，是因为看蜂人看得不够努力，于是雇了一位看看蜂人(Bee Watcher Watcher)来监督看蜂人的工作，可是，有了看看蜂人，看蜂人还是像过去一样努力地盯着蜜蜂们忙来忙去，并没有因为有了看看蜂人，看蜂人就眼晴睁得更大点。一年又过去了，蜂蜜的产量还是没有提高，分析原因，农场主得出了结论是因为看看蜂人监督看蜂人监督蜜蜂采蜜不够努力，于是他又雇了名看看看蜂人(Bee Watcher Watcher Watcher)来监督看看蜂人监督看蜂人监督蜜蜂采蜜的工作。一年又一年，越来越多的看看看&hellip;看峰人(Bee Watcher Watcher &hellip;.. Watcher)，产量还是没有提高，而生产成本却一年比一年高。</p>

<p><img src="http://blog.zhangliaoyuan.com/images/2013-06-25/beewatcher_lg.gif" title="The Bee Watcher" alt="Alt text" /></p>

<p><em>picture from <a href="http://www.drseussart.com/details/illustration/beewatcher.html" title="The Bee Watcher">The Bee Watcher - The Art of Dr. Seuss</a></em></p>

<p>我很喜欢这个故事，不是因为绕口令一样的角色名字，而是让我发现了身边藏着的Bee Watcher。我们制定了一个Process，期望它能极大地改善我们的研发状况，可是发现不尽如人意，原因可能是Process执行得不到位，于是，我们制定了更多的Process来确保我们的Process能更好地得到执行。这难道不是一个Bee Watcher。你发现了吗？请将更多的Bee Watcher以Comments形式告诉我吧，对我而言，这一定会是一个不错的收获。:\</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Exception Has Been Normal]]></title>
    <link href="http://blog.zhangliaoyuan.com/blog/2013/05/30/exception-has-been-normal/"/>
    <updated>2013-05-30T18:31:00+08:00</updated>
    <id>http://blog.zhangliaoyuan.com/blog/2013/05/30/exception-has-been-normal</id>
    <content type="html"><![CDATA[<p>My friend Simon talked with me, he would like to buy some instant coffee or ice cream in supermarket, but he found that, all of them including one ingredient is non-dairy creamer(植脂末). This ingredient is used to make the drink more smooth, it&rsquo;s a replacement of milk, but it&rsquo;s bad for human health. Any way, it&rsquo;s better than melamine(三聚氰胺). Nowadays, you are hard to find instant coffee without non-dairy in China.</p>

<p>Another story what I heard there is a government department named as &ldquo;temporary emergency processing center for cover of sewer well&rdquo; (窨井盖临时应急处理中心) is hiring a fixed officer. And as government perspective view, this department will be always existed even the name including &ldquo;temporary&rdquo;, the reason is they have to alwyas handle the &ldquo;temporary&rdquo; &amp; &ldquo;emergency&rdquo; issue. But as I know, the cover of sewer well shall be managed by municipal administration.</p>

<p>The third story is restrict the car to solve the traffic jam, i.e. if the last digit of your car license plate number is 1 or 9, your car will be ban on road on Monday, 2 or 8 will be ban on road on Tuesday, and so on&hellip;. This is a temporary solution for traffic jam issue, but currently, it&rsquo;s becoming a final solution, it&rsquo;s normal for administration department.</p>

<p>So we can understand from those stories, once problem happen, there will be temporary solution coming, in programming area, we called &ldquo;workaround&rdquo;, and there is no further analysis, and temporary solution will act as final solution, workaround will act as solution. Once there is another problem happen, there will be another temporary solution coming, or another &ldquo;workaround&rdquo; be used. A workaround helps to solve another workaround, and another workaround is used to solve another another workaround problem&hellip;.</p>

<p>But why? I often ask this question to myself and my colleague. It might be caused by lazy, yes, that&rsquo;s one reason. But another problem in government administration area, the temporary solution can solve some problems of employment, and there will be more position for officer ask, even it&rsquo;s not needed. In software programming area as well, more workaround, more maintenance is needed, and more engineers are needed. But all of us forget one thing is find out the root cause, and fix it.</p>

<p>If exception has been normal, around of you use workaround solve another problem of workaround, it means the situation around of you has been worse, you need to consider quit only if you can solve it. :\</p>
]]></content>
  </entry>
  
</feed>
